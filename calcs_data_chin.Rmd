```{r include=FALSE}
page_title <- "Chinook Model Detail"
```

---
title: `r page_title`
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE, results = 'hide', warning = FALSE, message = FALSE, echo=FALSE}
#knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.height=9, fig.width=9)
```

# 1. Chinook Model Structure

## 1.1. Stocks

Currently, 39 <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Stock" target = "_blank" title = "Stock">stock</a> groups are represented in Chinook <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Fishery_Regulation_Assessment_Model_(FRAM)" target = "_blank" title = "FRAM: Fishery Regulation Assessment Model">FRAM</a>.  Each of these stock groups have both <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Marked" target = "_blank" title = "marked">marked</a> (adipose fin clipped) and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Unmarked" target = "_blank" title = "Unmarked">unmarked</a> components to permit assessment of mark-selective fishery regulations; therefore, the current version of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> has a total of 78 stock units (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_2_Chinook_FRAM_stocks" target = "_blank" title = "Appendix 2">Appendix 2</a>). Each stock unit includes four age classes: 2s, 3s, 4s, and 5+.

Model stocks may represent an individual salmon stock or an aggregate of stocks from the same region.  Stock units represented in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> were chosen based on the level of management interest, their contribution to <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pacific_Fishery_Management_Council_(PFMC)" target = "_blank" title = "PFMC: Pacific Fishery Management Council">PFMC</a> fisheries, and the availability of representative coded-wire tag (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Coded-Wire_Tag_(CWT)" target = "_blank" title = "CWT: Coded-wire tag">CWT</a>) recoveries in the Regional Mark Information System (<a title = "RMIS: Regional Mark Information System" href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Regional_Mark_Information_System_(RMIS)" target = "_blank">RMIS</a>). For Chinook stock profiles listing hatcheries selected to represent the stock aggregate during calibration, tag codes, growth functions, etc, see <a href = "https://framverse.github.io/fram_doc/base_chin.html#2_Stock_Profiles" target = "_blank" title = "Chinook Stock Profiles">Base Period Stock Profiles</a>.

Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes most stock groups originating from the California Central Valley (Sacramento River), Oregon coast, Columbia River, Washington coast, Puget Sound, and Southern British Columbia.  However, not all stocks along the West Coast of North America are represented.  Some of the stocks that are not represented in Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> include all those originating from California with the exception of Sacramento River fall Chinook, Oregon stocks originating south of Elk River, Mid and Upper Columbia River spring Chinook, Snake River spring and summer Chinook, and Canadian stocks originating north of Georgia Strait. 

## 1.2. Fisheries

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes fisheries from southeast Alaska, Canada, Puget Sound, and off the coasts of Washington, Oregon, and California.  The 73 fisheries in Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> are designed to account for most of the fishing-related impacts to modeled Chinook stocks. A unique fishery identification number and fishery name for each of the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries are listed in <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_4_Chinook_FRAM_fisheries" target = "_blank" title = "Appendix 4">Appendix 4</a> for Chinook. <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Fishery" target = "_blank" title = "Terminal fishery">Terminal fisheries</a> in Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> are aggregations of gear and management areas. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can model non-selective fisheries, mark-selective fisheries, and non-retention fisheries, and also calculates fisheries-related <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Incidental_Mortality" target = "_blank" title = "Incidental mortality">incidental</a> and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Sublegal" target = "_blank" title = "Sublegal">sublegal</a> mortalities. 

## 1.3. Time Steps

Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> consists of four time periods (Table 1).  Because the fishery management cycle year (May 1 to April 30) for Chinook is out of sync with the time at which most Chinook in the model age up (October 1), Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> both begins and ends with an October to April <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Time_Step" target = "_blank" title = "Time step">time step</a>.

Table 1. Time steps of Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>.
```{r calcs_data_chin_t1_timesteps, echo=FALSE}
dplyr::tibble(
  `Time Step` = c(1:4),
  Months = c("Preceding Oct. - April", "May - June", "July - September", "Oct. - April")
  ) |> gt::gt()
```

The time step structure used in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> represents a level of resolution that balances data availability, fishery management structure, and species-specific migration and maturation schedules. The amount of available <span title = "CWT: Coded Wire Tag">CWT</span> recovery data (used to estimate model <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Parameter" target = "_blank" title = "Parameter">parameters</a> such as exploitation rates and maturation rates) limits the time-step resolution of the model, as these data are stratified by stock unit, age class, and fishery.  

Reducing the duration of time steps decreases the number of <span title = "CWT: Coded Wire Tag">CWT</span> recoveries, and thereby increase the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Variance" target = "_blank" title = "Variance">variance</a> of the estimated parameters in those strata. Accordingly, time steps were defined at a minimum resolution needed for fishery management purposes. During each time step, a cohort undergoes <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Natural_Mortality" target = "_blank" title = "Natural mortality">natural mortality</a>, and can be subjected to <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pre-terminal_Fishery" target = "_blank" title = "Pre-terminal fishery">pre-terminal fisheries</a>, maturation, and terminal fisheries. 

# 2. Assumptions and Limitations

*The model has several major assumptions and limitations.*

**<span title = "CWT: Coded Wire Tag">CWT</span> fish accurately represent the modeled stock.** The model parameterization depends on <span title = "CWT: Coded Wire Tag">CWT</span> recoveries, overwhelmingly from <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Hatchery" target = "_blank" title = "Hatchery">hatchery</a> origin production. The model therefore assumes that the distribution and exploitation of the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Tagged" target = "_blank" title = "Tagged">tagged</a> fish in each stock unit are the same as that of <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Untagged" target = "_blank" title = "Untagged">untagged</a> fish.

**Stock distribution and migration are constant from year to year and is represented by the average distribution of <span title = "CWT: Coded Wire Tag">CWT</span> recoveries during the reference <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Base_Period" target = "_blank" title = "Base period">base period</a>.**  Annual variability in the distribution and migration patterns of Chinook and Coho salmon stocks remains an active area of research.

**Each stock unit and age class is exploited as a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Single_Pool_Model" target = "_blank" title = "Single pool model">single pool</a>.**  All pre-terminal fisheries operate on the entire cohort simultaneously in each time step and all terminal fisheries operate on the mature run. Thus, base period exploitation rate parameter differences may implicitly account for some within-timestep spatiotemporal patterns, but dynamics such as the sequence of interceptions in fisheries that occur in different months or at different positions along a returning migratory path are not explicitly modeled. 

**Length at age is stock specific and is constant from year to year.**  The proportion of an age class that is of <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Legal-sized" target = "_blank" title = "Legal size">legal size</a> in size-limit fisheries is determined using the <a title = "VBGF: von Bertalanffy growth function" href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Von_Bertalanffy_Growth_Function" target="_blank">von Bertalanffy growth function</a>. It is assumed that growth in the current model year is similar to that in the years used to estimate the growth parameters (McHugh et al. 2015). 

**Age-specific maturation rates vary by stock but are constant from year to year.**  Maturation rates are calculated on a stock, age, and time step-specific basis from cohort reconstructions during the base period <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Calibration" target = "_blank" title = "Calibration">calibration</a>. This assumes maturation rates during the base period years adequately characterize those in any given model run year.

**Natural mortality is constant from year to year.** Rates for Chinook are age and time period specific and yield the same total annual natural mortality rate used in the Pacific Salmon Commission (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pacific_Salmon_Commission_(PSC)" target = "_blank" title = "PSC: Pacific Salmon Commission">PSC</a>) Exploitation Rate Analysis (<a href = "https://framverse.github.io/fram_doc/calcs_citations.html" target = "_blank" title = "PSC 2021">PSC 2021</a>).

**Release mortality and drop-off rates are fishery and time step specific and constant between stocks and from year to year.** Note: mortality rates can be updated, but this is done very infrequently; i.e., only a few rates have been updated in the past 30 years.

**Fish in a specific time/area/fishery stratum do not experience <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Multiple_Encounter" target = "_blank" title = "Multiple encounters">multiple gear</a> <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Encounter" target = "_blank" title = "Encounter">encounters</a>.**  The catch equations used in the model are discrete and not <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Instantaneous_Equations" target = "_blank" title = "Instantaneous equations">instantaneous</a>, so that fish are assumed to be vulnerable to the gear only once within each time/area/fishery stratum.  Potential <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Mark_Selective_Fishing_Bias" target = "_blank" title = "Mark selective fishing bias">bias</a> in the estimates may increase with large mark-selective fisheries or longer time intervals, both of which increase the likelihood that fish will encounter a gear more than once.


# 3. Model Parameterization

The numeric inputs needed to run <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> are stored as tables in a Microsoft Access database, along with tables containing resulting model outputs. 

These input tables consist of: 

 - static, base period parameter values derived or agreed to during the process of calibration (e.g., base period exploitation rates, natural mortality rates, growth rates) and
 - annual stock and fishery values including forecast or observed run sizes, <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Landed_Catch" target = "_blank" title = "Landed catch">catch</a> in a fishery: a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Quota" target = "_blank" title = "Quota">quotas</a>, <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Size_Limit" target = "_blank" title = "Size limit">size limits</a>, etc. 
 
The main <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> outputs are estimates of mortalities (landed, mark-selective, sub-legal, non-retention, drop-off) and abundances (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Starting_Cohort" target = "_blank" title = "Starting cohort">starting cohorts</a> at each time step; abundances after natural mortalities, pre-terminal, and terminal fisheries).

Table 2. Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> Microsoft Access Database Tables.

```{r calcs_data_chin_t2_mdb, echo=FALSE, out.width='100%'}
#could fuss with subscript formatting in Calc_Fields...
#readxl::read_excel("O:/fram/fram_documents/fram_mdb_tables.xlsx") |> 
#  dplyr::filter(Class != "unused", Species != "Coho") |>
#  tidyr::unite(Values, Class, Values, sep = " ") |> 
#  dplyr::select(-Species) |> 
#  dplyr::mutate(dplyr::across(dplyr::everything(), ~tidyr::replace_na(., ""))) |> 
#  gt::gt(groupname_col = "Values")

knitr::include_graphics(c("images/Chinook_FRAM_database_tables.PNG"))
```

## 3.1. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> Input Data

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> input data consist of two main input types: base period reference data and annual data.  Base period data remain constant until a new base period replaces the existing one.

The principal inputs stemming from the base period are stock-age-fishery-time step specific exploitation rates.  Other base period parameters include maturation rates, adult equivalency (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Adult_Equivalent_(AEQ)" target = "_blank" title = "Adult equivalent">AEQ</a>) values,  <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Cohort_Size" target = "_blank" title = "Cohort size">cohort sizes</a>, and model stock proportions (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Model-Stock_Proportion_(MSP)" target = "_blank" title = "MSP: Model-stock proportion">MSP</a>).  

The second input type consists of annual data that can vary with each model run, such as stock specific abundance estimates, fishery catches, size limits, etc.  

###	3.1.1. Base Period Data

<span title = "CWT: Coded Wire Tag">CWT</span> recoveries are used to estimate model parameters such as age-specific time/area/fishery exploitation rates and maturation rates for modeled stocks.  The years from which <span title = "CWT: Coded Wire Tag">CWT</span> recoveries are used to estimate these parameters are referred to as the "base period."  These parameter estimates are derived through species-specific <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Cohort_Analysis" target = "_blank" title = "Cohort analyses">cohort analyses</a>.  Each cohort analysis is a series of procedures that use <span title = "CWT: Coded Wire Tag">CWT</span> recoveries along with base period catch and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Escapement" target = "_blank" title = "Escapement">escapement</a> data to “back-calculate,” or reconstruct, a pre-fishing cohort size for each stock and age group using assumed natural mortality and incidental mortality rates.  See (<a href = "https://framverse.github.io/fram_doc/calcs_citations.html#Literature_cited" target = "_blank" title = "Model Evaluation Workgroup, 2008">Model Evaluation Workgroup, 2008</a>) for a more detailed description of the cohort analysis procedures.

The model base period data for Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> are derived from cohort reconstruction based on aggregated <span title = "CWT: Coded Wire Tag">CWT</span> data from several consecutive brood years.  Currently, the Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> base period is calibrated using escapement, catch, and <span title = "CWT: Coded Wire Tag">CWT</span> recovery data (fishing calendar years 2007-2013) from brood year 2005-2008 (2007-2009 for Central Valley) <span title = "CWT: Coded Wire Tag">CWT</span> releases.  Not all stocks represented in the Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> have <span title = "CWT: Coded Wire Tag">CWT</span> recovery data available from base period brood years (e.g., White River Spring Chinook); these stocks are categorized as “out-of-base” (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Out-of-Base_(OOB)" target = "_blank" title = "OOB: Out of base">OOB</a>) stocks.  Available <span title = "CWT: Coded Wire Tag">CWT</span> data for the <span title = "OOB: Out of base period">OOB</span> stocks are translated to equivalent base period recovery and escapement data using known fishing effort and harvest relationships between recovery years.  

###	3.1.2. Annual and Semi-static Data

These data are comprised of six general types of input.  Four of these input types <span title = "a. Cohort abundance; b. Size limits; c. Fishery landed catch; e. Mark-selective fisheries">(a, b, c, e)</span> are submitted annually to reflect projected stock abundances and proposed fishery regulations for the current model year.  The remaining two types of input <span title = "d. Release mortality rates; f. Other non-landed mortality rates">(d, f)</span> are specifications for fishery-related mortalities that can change as more information becomes available through additional data collection or studies, but typically do not change annually.

**a.** *Cohort Abundance*:  For each stock unit, an annual abundance is obtained from regional experts, typically in the form of a terminal run size (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Run_Size" target = "_blank" title = "TRS: Terminal run size">TRS</a>).  In a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pre-season" target = "_blank" title = "Pre-season">pre-season</a> context these abundances come from annual forecast predictions, whereas in a <a href = https://framverse.github.io/fram_doc/calcs_glossary.html#Post-season" target = "_blank" title = "Post-season">post-season</a> context the abundances are estimates of actual returns.  For Chinook, initial stock abundance estimates are needed by age class (ages 2 through 5) and mark status. 

**b.** *Size Limits*:  For Chinook, minimum size limits, as set by fishery regulations, are provided by fishery and time step.  

**c.** *Fishery Landed Catch*:  The model provides three options for setting the  <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Landed_Catch" target = "_blank" title = "Landed catch">catch</a> in a fishery: a quota, a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Fishery_Scaler" target = "_blank" title = "Fishery scaler">fishery scaler</a>, and a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Harvest_Rate_(HR)" target = "_blank" title = "HR: Harvest rate">harvest rate</a> (for Puget Sound terminal fisheries only). <br>
<u>Quota</u>:  Catch in the fishery is set equal to a numeric value input by the user.<br>
<u>Fishery Scaler</u>: The fishery is scaled relative to the effort during the reference base period using a scaler value input by the user. The catch resulting from a scaler is a function of base period exploitation rates and stock abundances.  <br>
<u>Harvest Rate</u>:  Using the Puget Sound <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Area_Management_Module_(TAMM)" target = "_blank" title = "TAMM: Terminal Area Management Module">TAMM</a>, a terminal area harvest rate can be applied to terminal area fisheries. For a list of terminal fisheries see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_4_Chinook_FRAM_fisheries" target = "_blank" title = "Appendix 4">Appendix 4</a>.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> inputs for quota and fishery scaler can be identified as either a conventional retention fishery or a mark-selective fishery and modeled accordingly.  Modeling as a mark-selective fishery initiates additional calculations to estimate catches, encounters, and mortalities differently for marked and unmarked groups.

**d.** *Release Mortality Rates*:  This is the mortality associated with the release of fish from hook-and-line and other gear types. Release mortality rates are designated by species, geographic area, fishery type, fishery size (legal vs. sublegal) and gear type (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>). Release mortality is assessed when Chinook are not retained (“non-retention” or <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#ChinookCoho_Non-retention_(CNR)_Fisheries" target = "_blank" title = "CNR: Chinook non-retention">CNR fisheries</a>), when size limits apply, and in mark-selective fisheries. A number of studies have estimated release mortality for hook-and-line fisheries, and release mortality rates for both <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Troll_Fishery" target = "_blank" title = "Troll fishery">troll</a> and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Recreational_Fisheries" target = "_blank" title = "Recreational fisheries">recreational fisheries</a> in the ocean have been formally adopted by the <span title = "PFMC: Pacific Fishery Management Council">PFMC</span>.  For Chinook, release mortality rates differ between legal-sized fish (adult release mortality) and sublegal-sized fish (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Shaker_Mortality" target = "_blank" title = "Shaker mortality">shaker release mortality</a>).  Release mortality in net fisheries with non-retention is estimated externally to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and provided as an input to the model.

**e.** *Mark-selective fisheries* have two additional sources of mortality that are described as either the retention of an unmarked fish or the release of a marked fish that consequently experiences release mortality.  The failure to release unmarked fish is a user input to the model called “<u>Unmarked Retention Error</u>” (<span title = "Unmarked Retention Error">$ure$</span> or <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Unmarked_Retention_Error_Rate" target = "_blank" title = "Unmarked retention error rate">Retention Error Rate</a>) and is the proportion of the legal-sized unmarked fish encountered that are retained.  The release of marked fish is a user input to the model called “<u><a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Marked_Recognition_Error_Rate" target = "_blank" title = "Marked recognition error rate">Marked Recognition Error</a></u>” (<span title = "Marked recognition error">$mre$</span>) and it is the proportion of the legal-sized marked fish encountered that are released; these released marked fish are then subject to release mortality.  These rates are updated annually based on fishery monitoring data. 

**f.** *Other Non-landed Mortality Rates (Incidental Mortality)*:  This includes fishing-induced mortality not associated with directly handling fish.  <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Drop-off_Mortality" target = "_blank" title = "Drop-off mortality">Drop-off mortality</a> can occur when fish in sport and troll hook-and-line fisheries drop off the hook before they are brought to the vessel.  <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Drop-out_Mortality" target = "_blank" title = "Drop-out mortality">Drop-out mortality</a> occurs when fish in commercial net fisheries are not brought on board but die from injury as a result of encountering the net.  For simplicity, both types are referred to as drop-off mortality in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>.  Net drop-out mortality rates vary depending on species, net type, or timing (pre-terminal or terminal) of the fishery.  In general, a 5% drop-off mortality rate is applied to the landed catch (or legal-sized encounters in fisheries modeled as mark-selective) to account for “other <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Non-landedNon-retention_Mortality" target = "_blank" title = "Non-landed mortality">non-landed mortalities</a>” in hook-and-line fisheries (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>).


# 4. Model Calculations

<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

## 4.1. Overview

FRAM processes information through a time step loop, beginning with time step 1 and ending with time step 4  for Chinook.  Within each time step, a series of five computational processes occur for each stock and age, as depicted in Figure 1: (**1**) determine starting cohort size, (**2**) removal of natural mortality, (**3**) removal of pre-terminal fishery mortalities, (**4**) maturation, and (**5**) removal of terminal fishery mortalities.

```{r chinook flow chart image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/Chinook_FRAM_flowchart.PNG"))
```

Figure 1. Conceptual flow chart for the Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model.

## 4.2. Computational Processes

**Cohort Abundance**

<u>Process 1:  Cohort abundance at the start of the time step</u> <br>

The starting cohort size in time step 1 is a product of two parameters: (*1*) the base period cohort abundance for stock *s* at age *a* (<span title = "Base period cohort abundance estimate of stock s at age a">$BPCohorts_{s,a}$</span>) and (*2*) a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Stock_Recruit_Scaler" target = "_blank" title = "Stock recruit scaler">stock and age-specific recruit scaler</a> (<span title = "Stock recruit scaler of stock s at age a">$StockScalers_{s,a}$</span>).  

The starting cohort is generally calculated from pre-season forecasts or post-season assessments of terminal run size during Backwards FRAM (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Backwards_FRAM_(BkFRAM)" target = "_blank" title = "BkFRAM: Backwards FRAM">BkFRAM</a>) calculations. <span title = "BkFRAM: Backwards FRAM">BkFRAM</span> produces starting cohorts by expanding terminal run sizes for maturation, preterminal fisheries, and natural mortalities (see <a href = "https://framverse.github.io/fram_doc/calcs_data_chin.html#6_Backwards_FRAM" target = "_blank" title = "">Backwards FRAM</a> chapter).

<p>**(1)** <div style = "text-align:center"><span title = "Cohort abundance of stock s at age a during time step 1">$Cohort_{s,a,t\!=\!1}$</span> $=$ <span title = "Base period cohort abundance of stock s at age a">$BPCohort_{s,a}$</span> $\times$ <span title = "Stock recruit scaler of stock s at age a">$StockScaler_{s,a}$</span> </div> </p>
where <span title = "Cohort abundance of stock s at age a during time step 1">$Cohort_{s,a,t\!=\!1}$</span> is the initial cohort size for stock *s*, age *a*, during time step *t*=1.

The starting cohort abundance in all subsequent time steps is determined based on the remaining <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Immature" target = "_blank" title = "Immature">immature</a> cohort from the previous time step (see process 4 below).  Chinook age between time step 3 and 4, so that, for example, age 2 fish in time step 3 become age 3 fish in time step 4.  Since there are no age 1 fish in Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>, the age 2 cohort in time step 4 is the same as the age 2 cohort in time step 1. 

**Natural Mortality**

<u>Process 2: Natural mortality within each time step</u> <br>

During each time step, the stock-age cohort size at the start of the time step is decreased to account for natural mortality:

<p>**(2)** <div style = "text-align:center"><span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Discrete natural mortality rate at age a and time step t">$(1-M_{a,t})$</span> </div> </p>

where <span title = "Discrete natural mortality rate at age a and time step t">$M_{a,t}$</span> is the discrete natural mortality rate for age *a* fish during time step *t* (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_8_Time_period_and_age-specific_rates_used_by_FRAM_to_simulate_Coho_and_Chinook_natural_mortality" target = "_blank" title = "Appendix 8">Appendix 8</a>).

**Pre-terminal fisheries**

<u>Process 3: Pre-terminal fishery mortality</u> <br>

The remaining cohort is then subjected to removals by pre-terminal fisheries; both landed catch and non-landed mortalities associated with each fishery are calculated.  <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> simulates fishery mortalities using different processes depending upon the type of fishery: retention fishery (non-selective), non-retention fishery, or mark-selective fishery. 

<u>**3a.** In regular retention fisheries (non-selective), landed catch is estimated as:</u>

<p>**(3)** <div style = "text-align:center"><span title = "Landed catch of stock s at age a in fishery f during time step t">$Catch_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Base period exploitation rate of stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Portion vulnerable of stock s at age a in fishery f during time step t">$PV_{s,a,f,t}$</span> $\times$ <span title = "Stock fishery rate scaler for stock s in fishery f at time step t">$SHRF_{s,f,t}$</span> </div> </p>

where, <br>

- <span title = "Base period exploitation rate of stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> is the base period exploitation rate for stock *s*, at age *a*, in fishery *f*, during time step *t*. <br>
- <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> is an annual model input that relates expected effort in the model year back to average effort during the base period. <br>
- <span title = "Portion vulnerable of stock s at age a in fishery f during time step t">$PV_{s,a,f,t}$</span> is the portion of the stock cohort *s*, at age *a*, during time step *t* that is of legal size for fishery *f* (i.e. portion vulnerable; <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Proportion_Vulnerable_(PV)" target = "_blank" title = "PV: Proportion vulnerable">PV</a>). <span title = "PV: Portion vulnerable">PV</span> is calculated by <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> using a stock-specific <a title = "VBGF: von Bertalanffy growth function" href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Von_Bertalanffy_Growth_Function" target="_blank">von Bertalanffy growth function</a>. <br>
- <span title = "Stock fishery rate scaler for stock s in fishery f at time step t">$SHRF_{s,f,t}$</span> is the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Stock_Fishery_Rate_Scaler_(SHRF)" target = "_blank" title = "SHRF: Stock Fishery Rate Scaler">stock fishery rate scaler</a>. This scaler is optional and can be used to adjust impacts for individual stocks in a fishery and time step; i.e., if <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output for an individual stock significantly deviates from expectations, then the user can make adjustments by providing a <span title = "SHRF: Stock fishery rate scaler">$SHRF$</span> scaler. The stock fishery rate scaler was conceived to adjust the base period exploitation rate without the need to conduct a full calibration.

The <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> is the foundation for the fisher simulation algorithms. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can evaluate two general types of fisheries: catch-based or effort-based. For catch-based fisheries, the <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> is computed by <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> to obtain a user-specified catch level (i.e. a quota). This occurs in a two-step process. First, the fishery is modeled with a scaler of 1. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> then computes the ratio of target catch (quota) to modeled catch. This ratio becomes the final fishery scaler. For effort-based fisheries, the <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> is specified by the user to reflect expected effort during the model year relative to the average effort observed during the base period.

<u>**3b.** Drop-off mortalities are estimated</u> by multiplying either **a**) landed catch in a non-selective retention fishery, or **b**) legal encounters in a mark-selective fishery, by a user-specified drop-off mortality rate (<span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span> see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>)

**a)** Non-selective retention fishery *f*:
<p>**(4a)**<div style = "text-align:center"><span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $=$ <span title = "Landed catch of stock s at age a in fishery f during time step t">$Catch_{s,a,f,t}$</span> $\times$ <span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span> </div> </p>
**b)** Mark-selective fishery *f*:
<p>**(4b)**<div style = "text-align:center"><span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $=$ <span title = "Number of legal encounters of stock s at age a in fishery f during time step t">$LegalEncounters_{s,a,f,t}$</span> $\times$ <span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span></div></p>

<u>**3c.** Sublegal mortalities</u> (<span title = "Sublegal mortalities of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span>) are calculated for the portion of the cohort that is caught but cannot be retained due to size limit restrictions:

<p>**(5)**<div style = "text-align:center"><span title = "Sublegal mortalities of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times (1 \ -$ <span title = "Portion vulnerable of stock s at age a in fishery f during time step t">$PV_{s,a,f,t})$</span> $\times$ <span title = "Sublegal encounter rate of stock s at age a in fishery f during time step t">$SLER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Release mortaility rate for sublegal fish in fishery f during time step t">$ShakerReleaseMortalityRate_{f,t}$</span> </div> </p> 

where,

- <span title = "Sublegal encounter rate of stock s at age a in fishery f during time step t">$SLER_{s,a,f,t}$</span> is the sublegal encounter rate from the base period. <br>
- <span title = "Release mortaility rate for sublegal fish in fishery f during time step t">$ShakerReleaseMortalityRate_{f,t}$</span> is the release mortality rate for sublegal fish in fishery *f* and time step *t* (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>).

There is only one <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> to model both retention and sublegal mortality. The fishery scaler provided to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> is designed to achieve the expected catch in the retention fishery. Therefore, sublegal mortality is determined by the fishery scaler used to model the retention fishery, resulting in modeled sublegal mortalities that often do not match observations/expectations. To address this problem, sublegal mortalities can be adjusted by multiplication with an <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Encounter_Rate_Adjustment" target = "_blank" title = "Encounter rate adjustment">encounter rate adjustment</a> (<span title = "Encounter rate adjustment for sublegal encounters in fishery f at age a during time step t">$EncRateAdjust_{f,a,t}$</span>). The encounter rate adjustment is computed in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> by multiplying landed (legal) catch for a fishery, age, and time step with an externally estimated sublegal/legal ratio (<span title = "Target ratio of sublegal to legal landed catch">$TargetRatio_{f,a,t}$</span>), which can be provided as a user input.

<p>**(6)**<div style = "text-align:center"><span title = "Adjusted sublegal encounters for stock s at age a in fishery f during time step t">$AdjustedShakers_{s,a,f,t}$</span> $=$ <span title = "Sublegal encounters of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span> $\times$ <span title = "Encounter rate adjustment for sublegal encounters in fishery f at age a during time step t">$EncRateAdjust_{f,a,t}$</span> </div> </p>

<p>**(7)**<div style = "text-align:center"><span title = "Encounter rate adjustment for sublegal encounters in fishery f at age a during time step t">$EncRateAdjust_{f,a,t}$</span> $=$ <span title = "Legal catch in fishery f at age a during time step t">$(Catch_{f,a,t}$</span> $\times$ <span title = "Target ratio of sublegal to legal landed catch">$TargetRatio_{f,a,t})$</span> $\div$ <span title = "Sublegal encounters in fishery f of age a during time step t">$Shakers_{f,a,t}$</span> </div> </p> 

where,

- <span title = "Sublegal encounters in fishery f of age a during time step t">$Shakers_{f,a,t}$</span> is the sublegal encounters summed over stocks in fishery *f* at age *a* during time step *t*.
- <span title = "Legal catch in fishery f at age a during time step t">$Catch_{f,a,t}$</span> is the legal catch summed over stocks in fishery *f* at age *a* during time step *t*.

<u>**3d.** Chinook non-retention (CNR) mortalities are estimated </u> for time periods when fishing is allowed, but the retention of Chinook is prohibited.

Chinook non-retention mortalities are typically calculated using <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Shaker" target = "_blank" title = "Shaker">shaker</a> and adult release mortality rates (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>) and external estimates of either total adult encounters or legal and sublegal encounters. Several other methods exist in the modeling framework for Chinook (relative to the level of open versus non-retention effort within a time step) but are rarely used.

<u>**3e.** Mark-selective fisheries</u> (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Mark-Selective_Fishery_(MSF)" target = "_blank" title = "MSF: Mark-selective fishery">MSF</a>) require additional computations to calculate both the landed catch and the mortalities due to the release of fish.

To simplify calculations, the <span title = "PV: Proportion vulnerable">PV</span> and the <span title = "SHRS: Stock fishery rate scaler">SHRS</span> are excluded from calculations below:

For **marked stock** units, the landed catch is calculated using an additional term to account for marked-recognition error (the release of a marked fish) and is fishery and time step specific <span title = "Marked-recognition error in fishery f during time step t">$(mre_{f,t})$</span>:

<p>**(8a)**<div style = "text-align:center"><span title = "Mark-selective fishery catch of stock s at age a in fishery f during time step t">$MSFCatch_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Base period exploitation rate of stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times (1 \ -$ <span title = "Marked-recognition error in fishery f during time step t">$mre_{f,t})$</span> </div> </p>

For **unmarked stock** units, the landed catch is calculated using an additional term to account for unmarked retention error (the retention of an unmarked fish) and is fishery and time step specific <span title = "Unmarked retention error for fishery f during time step t">$(ure_{f,t})$</span>:

<p>**(8b)**<div style = "text-align:center"><span title = "Mark-selective fishery catch of stock s at age a in fishery f during time step t">$MSFCatch_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Base period exploitation rate of stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Unmarked-retention error for fishery f during time step t">$ure_{f,t}$</span> </div> </p>

Equations used to calculate adult release mortalities <span title = "Adult release mortalities">$(AdultRelMort)$</span> in mark-selective fisheries must account for marked recognition <span title = "Marked-recognition error">$(mre)$</span> and unmarked retention error <span title = "Unmarked retention error">$(ure)$</span> for marked and unmarked stock units and utilize fishery and time step-specific release mortality rates <span title = "Specific fishery mortality rate of fishery f during time step t">$(sfm_{f,t})$</span> (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_7_FRAMTAMM_fishery-related_mortality_rates_for_Chinook_salmon_(version_used_in_2021_pre-season_planning)" target = "_blank" title = "Appendix 7">Appendix 7</a>).

<p>**(9a) Marked:**<div style = "text-align:center"><span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Base period exploitation rate for stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Marked recognition error in fishery f">$mre_f$</span> $\times$ <span title = "Specific release mortality rate of fishery f during time step t">$sfm_{f,t}$</span> </div> </p>

<p>**(9b) UnMarked:**<div style = "text-align:center"><span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Base period exploitation rate for stock s at age a in fishery f during time step t">$BPER_{s,a,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times (1 \ -$ <span title = "Unmarked retention error in fishery f">$ure_f)$</span> $\times$ <span title = "Specific release mortality rate of fishery f during time step t">$sfm_{f,t}$</span> </div> </p>

Computations for Chinook mark-selective fisheries must also account for sublegal mortality, which does not differ between marked and unmarked components, i.e., sublegal Chinook share the same fate in non-selective and mark-selective fisheries - they are released. Drop-off mortalities in mark-selective fisheries are calculated by multiplying the drop-off mortality rate with the number of legal encounters, as described in process 3b above.

<u>**3f.** All pre-terminal fishery mortalities </u> in time step *t* for stock *s* at age *a* are totaled <span title = "TotMort: Total pre-terminal fishery mortalities">$(TotMort)$</span> and the size of the cohort is reduced accordingly.

<p>**(10)**<div style = "text-align:center"><span title = "Total pre-terminal fishery mortalities for stock s at age a during time step t">$TotMort_{s,a,t}$</span> $=$ <span class = "math" title = "Summed over fishery f">$\displaystyle\sum_f$</span> <span title = "Landed catch of stock s at age a in fishery f during time step t">$(Catch_{s,a,f,t}$</span> $+$ <span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $+$ <span title = "Sublegal encounters of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span> $+$ <span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a,f,t}$</span> $+$ <span title = "Non-retention mortality of stock s at age a in fishery f during time step t">$CNR_{s,a,f,t})$</span></div></p>

The remaining cohort is then calculated as:

<p>**(11)**<div style = "text-align:center"><span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $-$ <span title = "Total pre-terminal fishery mortalities for stock s at age a during time step t">$TotMort_{s,a,t}$</span> </div> </p>

Fishery mortality in pre-terminal Chinook fisheries in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can also be expressed in terms of adult equivalents (<span title = "AEQ: Adult equivalent mortalities">AEQ</span>), which is the number of fish that would have survived to maturity and escaped to spawn in the absence of fishing.  The <span title = "AEQ: Adult equivalent mortalities">AEQ</span> factors adjust for the natural mortality that would have occurred between the time/age the fish were caught and the time/age that they would have matured. All age-5 Chinook in the mature time step and terminal fisheries have an <span title = "AEQ: Adult equivalent mortalities">AEQ</span> factor of 1. The <span title = "AEQ: Adult equivalent mortalities">AEQ</span> factor is calculated during base period calibration using maturation rates <span title = "Maturation rate of stock s at age a during time step t">$(MatRate_{s,a,t})$</span> as:

<p>**(11a) For time steps 1 and 2:**<div style = "text-align:center"><span title = "Adult equivalent mortalities for stock s at age a during time step t">$AEQ_{s,a,t}$</span> $=$ <span title = "Maturation rate of stock s at age a during time step t">$MatRate_{s,a,t}$</span> $+ \ (1 \ -$ <span title = "Maturation rate of stock s at age a during time step t">$MatRate_{s,a,t})$</span> $\times \ (1 \ -$ <span title = "Discrete natural mortality rate at age a for time step t+1">$M_{a,t \!+ \! 1} )$</span> $\times$ <span title = "Adult equivalent mortalities for stock s at age a during time step t+1">$AEQ_{s,a,t \! + \! 1}$</span> </div> </p>

<p>**(11b) For time step 3 (final base period time step):**<div style = "text-align:center"><span title = "Adult equivalent mortalities for stock s at age a during time step t">$AEQ_{s,a,t}$</span> $=$ <span title = "Maturation rate of stock s at age a during time step t">$MatRate_{s,a,t}$</span> $+ \ (1 \ -$ <span title = "Maturation rate of stock s at age a during time step t">$MatRate_{s,a,t})$</span> $\times \ (1 \ -$ <span title = "Discrete natural mortality rate at age a for time step t+1">$M_{a \! + \!1,t \!= \! 1} )$</span> $\times$ <span title = "Adult equivalent mortalities for stock s at age a during time step t+1">$AEQ_{s,a \! + \! 1,t \! = \! 1}$</span> </div> </p>

<span title = "AEQ: Adult equivalent mortalities">AEQ</span> = 1 for Chinook terminal fisheries, regardless of age.

<p>**(12)**<div style = "text-align:center"><span title = "Adult equivalent total mortalities for stock s at age a during time step t">$AEQTotMort_{s,a,t}$</span> $=$ <span title = "Summed over fishery f">$\displaystyle\sum_f$</span> <span title = "Landed catch of stock s at age a in fishery f during time step t">$((Catch_{s,a,f,t}$</span> $+$ <span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $+$ <span title = "Sublegal encounters of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span> $+$ <span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a,f,t}$</span> $+$ <span title = "Non-retention mortality of stock s at age a in fishery f during time step t">$CNR_{s,a,f,t})$</span> $\times$ <span title = "Adult equivalent mortalities for stock s at age a during time step t">$AEQ_{s,a,t})$</span> </div> </p>

**Maturation**

Once all pre-terminal fisheries have been processed and the associated mortalities have been removed from the cohort, a stock, age, and time step-specific maturation rate from the reference base period <span title = "Maturation rate of stock s at age a during time step t">$(MatRate_{s,a,t})$</span> is applied to the remaining Chinook cohort.  The mature portion of the cohort <span title = "Mature cohort abundance of stock s at age a during time step t">$(MatureCohort_{s,a,t})$</span> is then available to those fisheries, during the same time step, that have been designated as harvesting only mature fish (terminal fisheries). 

<p>**(13)**<div style = "text-align:center"><span title = "Mature cohort abundance of stock s at age a during time step t">$MatureCohort_{s,a,t}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step t">$MatRate_{s,a,t}$</span> </div> </p>

In the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model, the majority of Chinook stocks mature in time step 3 (July - September). A few, mostly Spring Chinook stocks mature during time step 2 (May- June) and 3. Cowlitz and Willamette Spring Chinook mature in time step 1. For a table of maturation rates see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_9_Time_period_and_age-specific_rates_used_by_FRAM_to_simulate_Chinook_maturation" target = "_blank" title = "Appendix 9">Appendix 9</a>.

After maturation has occurred, the remaining immature portion of the cohort becomes the initial starting cohort size at the beginning of the subsequent time step, where:

<p>**(14a)** For time steps 2 and 3:<div style = "text-align:center"><span title = "Cohort abundance of stock s at age a during time step t+1">$Cohort_{s,a,t \! + \! 1}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step t">$Cohort_{s,a,t}$</span> $-$ <span title = "Mature cohort abundance of stock s at age a during time step t">$MatureCohort_{s,a,t}$</span> </div> </p>

<p>**(14b)** For time step 4:<div style = "text-align:center"><span title = "Cohort abundance of stock s at age a+1 during time step 4">$Cohort_{s,a \! + \! 1,t \! = \! 4}$</span> $=$ <span title = "Cohort abundance of stock s at age a during time step 3">$Cohort_{s,a,t \! = \! 3}$</span> $-$ <span title = "Mature cohort abundance of stock s at age a during time step 3">$MatureCohort_{s,a,t \! = \! 3}$</span> </div> </p>

<p>**(14c)** Except:<div style = "text-align:center"><span title = "Cohort abundance of stock s at age 2 during time step 4">$Cohort_{s,a \! = \! 2,t \! = \! 4}$</span> $=$ <span title = "Cohort abundance of stock s at age 2 during time step 1">$Cohort_{s,a \! = \! 2,t \! = \! 1}$</span> </div> </p>

**Terminal Fishery Mortality**

Terminal fishery mortality is calculated for the mature cohort only, using the same equations as for pre-terminal fishery mortality.  Fishery mortalities are summed, and the remainder of the mature cohort constitutes the escapement from <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries.

<p>**(15)**<div style = "text-align:center"><span title = "Total terminal fishery mortality for stock s at age a during time step t">$TotTermMort_{s,a,t}$</span> $=$ <span title = "Summed over terminal fishery f">$\displaystyle\sum_{f \in terminal}$</span> <span title = "Landed catch of stock s at age a in fishery f during time step t">$(Catch_{s,a,f,t}$</span> $+$ <span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $+$ <span title = "Sublegal encounters of stock s at age a in fishery f during time step t">$Shakers_{s,a,f,t}$</span> $+$ <span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a,f,t}$</span> $+$ <span title = "Non-retention mortality of stock s at age a in fishery f during time step t">$CNR_{s,a,f,t})$</span> </div> </p>

<p>**(16)**<div style = "text-align:center"><span title = "Escapement of stock s at age a during time step t">$Escapement_{s,a,t}$</span> $=$ <span title = "Mature cohort abundance of stock s at age a during time step t">$MatureCohort_{s,a,t}$</span> $-$ <span title = "Total terminal fishery mortality for stock s at age a during time step t">$TotTermMort_{s,a,t}$</span></div> </p>

Escapement is the number of fish that remain in the mature cohort after removal of all terminal-area fishery related mortality.  For Chinook, the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> escapement represents the ‘run-to-the-river’ as freshwater fisheries are not processed in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM.</span> 

**<span title = "TAMM: Terminal Area Management Module">TAMM</span> Iterations**

During a first pass, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> completes a run with the terminal fishery inputs stored in the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> database. These "seed" inputs usually stem from a previous model run. after this pass is complete, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> estimates terminal fishery impacts using values from <span title = "TAMM: Terminal Area Management Module">TAMM</span> and compares these to the original <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> results; if the numbers are equal (less than 0.1% or fewer than 4 fish difference), the model is done.  If these numbers are not equal, an <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#TAMM_Iterations" target = "_blank" title = "TAMM iterations">iterative</a> process is initiated during which <span title = "TAMM: Terminal Area Management Module">TAMM</span> terminal fishery impacts are used to adjust <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> terminal fishery impacts until there is convergence (Figure 2).  

Finally, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> sends the terminal marine and freshwater run sizes and fishing mortalities to the <span title = "TAMM: Terminal Area Management Module">TAMM</span> file for use in additional calculations and final reporting. For more information see <a href = "https://framverse.github.io/fram_doc/calcs_data_chin.html#5_Terminal_Area_Management_Module" target = "_blank" title = "Chapter 5">Chapter 5</a>.

## 4.3 Processing Schematic

To facilitate understanding of the sequencing of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> processing steps, Table 3 provides an example of how a Chinook stock’s cohort is processed by age and time step from starting cohort to escapement. For brevity, the table only shows ages 3 and 4, but these processing steps occur for all ages (2 to 5).

The starting cohort in time step 1 is first reduced by natural mortality. The remaining cohort is vulnerable to preterminal fisheries. After preterminal fishing, part or all of the cohort can mature. This typically occurs in time step 3, but for some early or late stocks can also occur in time steps 1 or 2. The mature cohort is then susceptible to terminal fisheries. The mature cohort not caught in terminal fisheries will go to escapement. The portion of the cohort that does not mature (number immature) becomes the starting cohort of the next time step. This cycle repeats until time step 4, when Chinook age up, i.e., age-3 fish become age-4 fish, etc. Immature Chinook of age a from time step 3 become the starting cohort of time step 4 age *a*+1. For age-2 fish, the time step 4 starting cohort is the same as the time step 1 cohort, because the model does not contain age-1 fish that could age-up.

Table 3. Example values of Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> processing steps for a stock at age 3 and age 4.
```{r chinook process schematic image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/Chinook_FRAM_process_schematic.PNG"))
```

## 4.4. Exploitation Rate Calculation

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> calculates stock specific mortalities and escapements that can ultimately be used to compute exploitation rates (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Exploitation_Rate_(ER)" target = "_blank" title = "ER: Exploitation rate">ER</a>). Exploitation rate calculations are not part of the main <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> algorithms and are not calculated by <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>. Since Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> does not account for freshwater fisheries, <span title = "ER: Exploitation rate">ERs</span> calculated using <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output represent only exploitation that occurs in marine fisheries (i.e., calculation of a total <span title = "ER: Exploitation rate">ER</span>, summed over all fisheries, is not possible). Thus, total <span title = "ER: Exploitation rate">ERs</span> are calculated for Puget Sound Chinook stocks in the <span title = "TAMM: Terminal Area Management Module">TAMM</span> file after processing additional freshwater fisheries and further delineating aggregated <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> stocks to finer scale populations.

Exploitation rates are computed as the sum of all <span title = "AEQ: Adult equivalent mortality">AEQ</span> fishery mortalities divided by <span title = "AEQ: Adult equivalent mortality">AEQ</span> fishery mortalities plus escapement.

**(17)**
<span title = "Exploitation rate of stock s is equal to the AEQ total mortality for stock s summed from time steps 2 to 4, summed over all ages divided by the AEQ total mortality for stock s summed from time steps 2 to 4, summed over all ages plus the escapement of stock s summed over time steps 1 to 3 and ages 3 to 5">$$ER_s = \frac{\displaystyle\sum\limits_a \displaystyle\sum\limits_{t \! = \! 2}^4 AEQTotMort_{s,a,t}}{\displaystyle\sum\limits_a \displaystyle\sum\limits_{t \! = \! 2}^4 AEQTotMort_{s,a,t} + \displaystyle\sum\limits_{a \! = \! 3}^5 \displaystyle\sum\limits_{t \! = \! 1}^3 Escapement_{s,a,t}}$$</span>

It is noteworthy that mortality is calculated as the sum of time step 2 to 4 (May-April$_{Year+1}$), while escapement is computed as the sum of time step 1 to 3 (October$_{Year-1}$-September). Hence, there is a misalignment between mortalities and scapement in the exploitation rate calculation. Time step 4 mortalities were chosen over time step 1 to account for fisheries that occur after September, as the fishery regulation cycle runs from May through April.

## 4.5. Size Limit Evaluations

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> uses a <a title = "VBGF: von Bertalanffy growth function" href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Von_Bertalanffy_Growth_Function" target="_blank">von Bertalanffy growth function</a> to estimate the proportion of a stock-at-age that is greater than the minimum size limit in a fishery and time step. As stated above, this proportion is also referred to as the <span title = "PV: Proportion vulnerable">PV</span>. Chinook greater than the minimum size limit are considered to be of “legal size” and thus vulnerable to be caught in a fishery. Conversely, Chinook smaller than the minimum size limit are of “sublegal size” and ineligible to be retained. 

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> uses different rates to model encounters of legal and sublegal fish. These rates are computed during the calibration process and are based on landed catch and encounter information during reference base period years. As such, they reflect the size limit conditions during the base period. If the size limit is changed, a portion of the population (with sizes between the old and the new size limit) that previously received a sublegal encounter rate will receive a legal encounter rate or vice versa. This leads to the total number of computed encounters varying with size limits, if effort remains constant.

To correct for this outcome, algorithms were introduced to hold total fishery encounters constant when size limits are changed.

When the new size limit is less than the reference base period size limit, the difference in sublegal encounters becomes landed catch and is added to the calculated landed catch that results under the base period size limit. The calculation of sublegal mortalities remains unchanged (see section 4.2 step 3c).   

<p>**(18)**<div style = "text-align:center"><span title = "New landed catch calculation of stock s at age a in fishery f during time step t">$NewLandedCatch_{s,a,f,t}$</span> $=$ <span title = "Original landed catch calculation of stock s at age a in fishery f during time step t">$OriginalLandedCatch_{s,a,f,t}$</span> $+$ <span title = "Original calculation of sublegal encounters of stock s at age a in fishery f during time step t">$(OriginalSublegalEncounters_{s,a,f,t}$</span> $-$ <span title = "New calculation of sublegal encounters of stock s at age a in fishery f during time step t">$NewSublegalEncounters_{s,a,f,t})$</span> </div> </p>

When the new size limit is greater than the base period size limit, the difference in landed catch becomes sublegal encounters, which are added to the calculated sublegal encounters that result under the base period size limit. These sublegal encounters are converted to sublegal mortality by multiplying by the sublegal release mortality rate.  The calculation of landed catch remains unchanged (see section 4.2 step 3a). 

<p>**(19)**<div style = "text-align:center"><span title = "New sublegal encounter calculation of stock s at age a in fishery f during time step t">$NewSublegalEncounters_{s,a,f,t}$</span> $=$ <span title = "Original sublegal encounter calculation of stock s at age a in fishery f during time step t">$OriginalSublegalEncounters_{s,a,f,t}$</span> $+$ <span title = "Original landed catch calculation of stock s at age a in fishery f during time step t">$(OriginalLandedCatch_{s,a,f,t}$</span> $-$ <span title = "New landed catch calculation for stock s at age a in fishery f during time step t">$NewLandedCatch_{s,a,f,t})$</span> </div> </p>

where,<br>

- <span title = "Original calculation of landed catch">$OriginalLandedCatch$</span> is the landed catch under base period size limit regulations
- <span title = "New calculation of landed catch">$NewLandedCatch$</span> is the landed catch under new size limit regulations
- <span title = "Original calculation of sublegal encounters">$OriginalSublegalEncounters$</span> is the sublegal encounters under base period size limit regulations
- <span title = "New calculation of sublegal encounters">$NewSublegalEncounters$</span> is the sublegal encounters under new size limit regulations

See (Hagen-Breaux et al. 2013) for a detailed description of the equations.

## 4.6. Model-Stock Proportion

While the stocks included in Chinook <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> account for the majority of the Chinook caught in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries, there are some stocks that are not represented in the model (see <a href = "https://framverse.github.io/fram_doc/calcs_data_chin.html#11_Stocks" target = "_blank" title = "Section 1.1: Stocks">section 1.1</a>). To account for these stocks, fisheries with non-model-stock impacts are supplied with an externally computed model-stock proportion (see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_4_Chinook_FRAM_fisheries" target = "_blank" title = "Appendix 4: Chinook FRAM fisheries">Appendix 4</a>). The Model-stock proportion <span title = "MSP: Model-stock proportion">(MSP)</span> is a constant that is either calculated independently or produced during base period development. It represents the percentage of a fishery’s total catch that is accounted for by model stocks. 

**(20)**
<span class = "math" title = "Model-stock proportion of fishery f is equal to the sum of catch for all stocks, ages, and timesteps for fishery f divided by the ">$$MSP_f = \frac{\displaystyle\sum\limits_{s,a,t} Catch_{s,a,f,t}}{TotalCatch_f}$$</span>

# 5. Terminal Area Management Module

The <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> program interacts with the Terminal Area Management Module (<span title = "TAMM: Terminal Area Management Module">TAMM</span>), a species-specific Microsoft Excel file, which allows users to specify alternative terminal fishery inputs and to calculate impacts on a finer level of resolution than <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>. <span title = "TAMM: Terminal Area Management Module">TAMM</span> has separate sections for each of the six Puget Sound terminal regions (<span title = "">PSSMP</span>) (Table 4) that are defined in the Puget Sound Salmon Management Plan (1985) for the State of Washington and the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Treaty_Tribes" target = "_blank" title = "Treaty Tribes">Treaty Tribes</a> of Puget Sound. <span title = "TAMM: Terminal Area Management Module">TAMM</span> is best understood in its historic context. It is a terminal-area-centric fisheries model. Prior to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> development, information of stock-specific fishery impacts was not readily available. Management was based on terminal run reconstructions that assigned 100% of terminal catches to the local stock and computed terminal harvest rates as catch in the terminal area divided by terminal run size. To this day, <span title = "TAMM: Terminal Area Management Module">TAMM</span> inputs for terminal marine fisheries still include non-local stock impacts. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> takes these inputs from <span title = "TAMM: Terminal Area Management Module">TAMM</span> and accounts for non-local stock impacts before reporting stock specific impacts back to <span title = "TAMM: Terminal Area Management Module">TAMM</span>. Additional <span title = "TAMM: Terminal Area Management Module">TAMM</span> functionality also supports development of unique regional management goals and allows managers the flexibility to analyze and report <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model output according to their needs.

Table 4. Puget Sound Terminal Management Regions.
```{r chin terminal management regions table, echo = FALSE}
dplyr::tibble(
  `Management Regions` = c(
    "Nooksack-Samish", "Skagit", "Stillaguamish-Snohomish", 
    "South Sound", "Hood Canal", "Strait of Juan de Fuca")
) |> gt::gt()
```
<br>
Common <span title = "TAMM: Terminal Area Management Module">TAMM</span> features:

- Receive user inputs for <span title = "TAMM: Terminal Area Management Module">TAMM</span> terminal fisheries 
- Receive user inputs for <span title = "TAMM: Terminal Area Management Module">TAMM</span> stock abundances 
- Receive user input for <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span> stock management criteria (updated annually)
- Provide fishery inputs to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> during <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span> iterations
- Receive <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output of fishery impacts on Puget Sound stocks (time steps 2-4)
- Use <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output to complete <span title = "TAMM: Terminal Area Management Module">TAMM</span> fishery impact modeling upon Puget Sound stocks
- Allocate marked and unmarked impacts to hatchery and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Natural" target = "_blank" title = "Natural">natural</a> units.
- Generate TAMM reports of combined <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and <span title = "TAMM: Terminal Area Management Module">TAMM</span> fishery impacts upon <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> (and Chinook <span title = "TAMM: Terminal Area Management Module">TAMM</span>) stock units. 

Chinook <span title = "TAMM: Terminal Area Management Module">TAMM</span> is a critical element of pre-season modeling for Puget Sound stocks, where management units tend to be smaller components of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> stock units.  To achieve adequate stock representation in ocean fisheries, the current Chinook base period data aggregates <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> stocks at a coarser level than is needed by management.  The Chinook <span title = "TAMM: Terminal Area Management Module">TAMM</span> provides the ability to model individual marine and freshwater net fisheries in Puget Sound by the smaller time intervals associated with fisheries directed at Chinook, Pink, Coho, Chum, or Steelhead.  In addition, test fisheries and fisheries in sub-areas can be specified.  Similarly, the Chinook <span title = "TAMM: Terminal Area Management Module">TAMM</span> allows individual freshwater sport fisheries in Puget Sound to be modeled (see Figure 3).

To carry out fishery-specific impact analyses on all populations of interest, Chinook <span title = "TAMM: Terminal Area Management Module">TAMM</span> requires additional input of hatchery and natural abundances of Puget Sound Chinook populations and harvest impacts from additional Puget Sound fisheries.  <span title = "TAMM: Terminal Area Management Module">TAMM</span> then sums the fine-scale fisheries impacts into <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-level impacts for subsequent input back into <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> iteratively finds the fishery scalers that produce the same catches <span title = "Catch calculated in FRAM">$(Catch_{FRAM})$</span> as those supplied by <span title = "TAMM: Terminal Area Management Module">TAMM</span> <span title = "Catch calculated in TAMM">$(Catch_{TAMM})$</span> in Puget Sound fisheries (Figure 3).  <span title = "TAMM: Terminal Area Management Module">TAMM</span> catches are either directly input into <span title = "TAMM: Terminal Area Management Module">TAMM</span> as catch values or calculated by <span title = "TAMM: Terminal Area Management Module">TAMM</span> with user input harvest rates (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Harvest_Rate_(HR)" target = "_blank" title = "HR: Harvest rate">HR</a>) multiplied by terminal run size (TRS).  The <span title = "TRS: Terminal run size">TRS</span> for a <span title = "TAMM: Terminal Area Management Module">TAMM</span> region/stock represents ‘run-to-the-river’ of a stock plus catches of all stocks in the terminal fisheries designated for that region.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> calculations for each terminal area:

During a first pass, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> completes a run with the terminal fishery inputs stored in the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> database. These "seed" inputs usually stem from a previous model run. After this pass is completed:

- Sum escapements over appropriate time steps
- Add terminal catches <span title = "Catch calculated in FRAM">$(Catch_{FRAM})$</span> to calculate <span title = "TRS: Terminal run size">TRS</span> (includes non-local stocks)
- Calculate the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fishery scaler that produces the <span title = "Catch calculated in TAMM">$Catch_{TAMM}$</span>:
<div style = "text-align:center"><span title = "Fishery scaler for a given area at a given time step">$FisheryScaler(area, time step)$</span> = <span title = "Catch calculated in TAMM for a given area at a given time step">$Catch_{TAMM}(area, time step)$</span> $\div$ <span title = "Catch calculated in FRAM for a given area at a given time step">$Catch_{FRAM}(area, time step)$</span> </div>
- Rerun <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and repeat these steps until <span title = "Catch calculated in TAMM">$Catch_{TAMM}$</span> is within 0.1% (or fewer than 4 fish) of <span title = "Catch calculated in FRAM">$Catch_{FRAM}$</span>.

```{r chinook FRAM TAMM flow chart image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/FRAM_TAMM_flowchart.PNG"))
```

Figure 3.  Conceptual flow chart for <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span> calculations.

# 6. Backwards <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>

Backwards <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Backwards_FRAM_(BkFRAM)" target = "_blank" title = "BkFRAM: Backwards FRAM">(BkFRAM)</a> is a utility that determines <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> starting cohorts when estimates of (extreme-) terminal run sizes and fishery catches (landed and non-retention) are provided.  The program iteratively adjusts stock recruit scalers (a surrogate for starting cohorts, see equation below) and runs <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> forward until the resulting escapements or terminal run sizes match the targets.  For Chinook, <span title = "BkFRAM: backwards FRAM">BkFRAM</span> calculates age 3 to 5 starting cohorts. Target abundances are generally closely aligned with historical definitions of terminal or extreme terminal run sizes (<span title = "TRS: Terminal run size">TRS</span>, <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Extreme_Terminal_Run_Size_(ETRS)" target = "_blank" title = "ETRS: Extreme terminal run size">ETRS</a>) used for pre-season forecasts or post-season accounting and exclude age 2s. 

Post-season <span title = "BkFRAM: backwards FRAM">BkFRAM</span> runs are generally conducted to create the starting cohorts that result in observed (extreme-)terminal run sizes given known fishery impacts.  These cohorts are needed to calculate post-season exploitation rates.  For Chinook, pre-season <span title = "BkFRAM: backwards FRAM">BkFRAM</span> runs are generally conducted to create starting cohorts that result in forecasted (extreme-)terminal run sizes.  These pre-season runs are regularly populated with recent year average fishery impacts to obtain ‘best’ estimates of pre-fishing abundances.

The Chinook algorithm uses forward (regular) <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> calculations to solve for the stock recruit scaler needed to obtain a target terminal run size, given known time step fishery catches, natural mortality rates, and maturation rates.  The only parameter changing between iterations are stock-specific catches, resulting in updated recruit scalers, resulting in new stock catches, etc.  

<p>**(21)**<div style = "text-align:center"><span title = "Stock scaler for stock s at age a during time step 1">$StockScaler_{s,a,t \! = \! 1}$</span> $=$ <span title = "Backwards FRAM target size for stock s at age a">$((BkTarget_{s,a}$</span> $+$ <span title = "Total mortalities of stock s at age a during time step 1">$(TotMort_{s,a,t \! = \! 1}$</span> $\times$ <span title = "Maturation Rate of stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1}$</span> $+$ <span title = "Total mortality of stock s at age a during time step 1">$(TotMort_{s,a,t \! = \! 1}$</span> $\times (1 \ -$ <span title = "Maturation Rate for stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 2">$M_{a,t \! = \! 2})$</span> $+$ <span title = "Total mortality of stock s at age a during time step 2">$TotMort_{s,a,t \! = \! 2})$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step 2">$MatRate_{s,a,t \! = \! 2}$</span> $+$ <span title = "Total mortality of stock s at age a during time step 1">$((TotMort_{s,a,t \! = \! 1}$ </span> $\times (1 \ -$ <span title = "Maturation rate of stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 2">$M_{a,t \! = \! 2})$</span> $+$ <span title = "Total mortality of stock s at age a during time step 2">$TotMort_{s,a,t \! = \! 2})$</span> $\times (1 \ -$ <span title = "Maturation rate of stock s at age a during time step 2">${MatRate_{s,a,t \! = \! 2})}$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 3">${M_{a,t \! = \! 3})}$</span> $+$ <span title = "Total mortality of stock s at age a during time step 3">$TotMort_{s,a,t \! = \! 3})$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step 3">$MatRate_{s,a,t \! = \! 3}))$</span> $+$ <span title = "Total terminal fishery mortality of stock s at age a during time step 1">$TotTermMort_{s,a,t \! = \! 1}$</span> $+$ <span title = "Total terminal fishery mortality of stock s at age a during time step 2">$TotTermMort_{s,a,t \! = \! 2}$</span> $+$ <span title = "Total terminal fishery mortality of stock s at age a during time step 3">$TotTermMort_{s,a,t \! = \! 3})$</span> $\div ((1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 1">$M_{a,t \! = \! 1})$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1})$</span> $+ (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 1">$M_{a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Maturation rate of stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 2">$M_{a,t \! = \! 2})$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step 2">$MatRate_{s,a,t \! = \! 2}$</span> $+ (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 1">$M_{a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Maturation rate of stock s at age a during time step 1">$MatRate_{s,a,t \! = \! 1})$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 2">$M_{a,t \! = \! 2})$</span> $\times (1 \ -$ <span title = "Maturation rate of stock s at age a during time step 2">$MatRate_{s,a,t \! = \! 2})$</span> $\times (1 \ -$ <span title = "Discrete natural mortality rate at age a during time step 3">$M_{a,t \! = \! 3})$</span> $\times$ <span title = "Maturation rate of stock s at age a during time step 3">$MatRate_{s,a,t \! = \! 3})$</span> $\div$ <span title = "Base period starting cohort abundance of stock s at age a">$BPCohort_{s,a}$</span> </div> </p>

where:

- <span title = "Backwards FRAM escapement or (extreme) terminal run size target">$BkTarget$</span> is the backwards <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> run size target; escapement or (extreme) terminal run size
- <span title = "Base period starting abundance of a cohort">$BPCohort$</span> is the base period starting cohort abundance
- <span title = "Stock recruit scaler">$StockScaler$</span> is the stock recruit scaler (abundance)

The program iterates until the resulting <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> escapement or terminal run size is within one fish of the target escapement or terminal run size and then terminates the iteration process.  

<p>**(22)**<div style = "text-align:center"><span title = "(Extreme) terminal run size estimate from a forward FRAM calculation for stock s at age a">$| \ FRAMescapement_{s,a}$</span> $-$ <span title = "Backwards FRAM escapement or (extreme) terminal run size target of stock s at age a">$BkTarget_{s,a} \ |$</span> $\le 1$ </div> </p>

where:

- <span title = "(Extreme) terminal run size estimate from a forward FRAM calculation">$FRAMescapement$</span> is the terminal run size resulting from a forward <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> run.

# 7. Output Reports

Model results are available in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> screen reports viewed within the software, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> print reports, <span title = "TAMM: Terminal Area Management Module">TAMM</span> Microsoft Excel files, or can be extracted from the species-specific Microsoft Access database associated with the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> run. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> reports include summaries of projected catch and mortalities by fishery, stock, and age. The <span title = "TAMM: Terminal Area Management Module">TAMM</span> files provide comprehensive summaries of fishery mortalities, exploitation rates, run sizes, and escapements for key Puget Sound stocks in the <span title = "PFMC: Pacific Fishery Management Council">PFMC</span> and North of Falcon (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#North_of_Falcon_(NOF)" target = "_blank" title = "NOF: North of Falcon">NOF</a>) annual pre-season planning process.  Several external files are used by <span title = "PFMC: Pacific Fishery Management Council">PFMC</span> for specific Chinook model results, for the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Snake_River_Fall_Chinook_Index_(SRFI)" target = "_blank" title = "SRFI: Snake River fall Chinook index">Snake River Fall Chinook Index</a> (SRFL.xls) and lower Columbia River natural tule Chinook (Coweeman.xls). For a full scope of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> report generating functions, refer to the online <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> <a href = "https://framverse.github.io/fram_doc/user_prereq.html" target = "_blank">User Manual</a>.  

<br>

To cite this page: <br>
`r paste("Salmon modeling and analysis workgroup.", format(Sys.Date(), "%Y."), page_title, "*in* FRAM Documentation. https://framverse.github.io/fram_doc/ ", paste("built", format(Sys.Date(), "%B %d, %Y.")))`
