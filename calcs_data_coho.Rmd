---
title: "Coho Calculations"
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE, results = 'hide', warning = FALSE, message = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.height=9, fig.width=9)
```

# 1. Model Structure

## 1.1. Stocks

Currently, 123 stock groups are represented in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>. Each of these stock groups have both marked (adipose fin clipped) and unmarked components to permit assessment of mark-selective fishery regulations; therefore, the current version of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> has a total of 246 stock units (**Appendix 1**).  Model stocks may represent an individual salmon stock or an aggregate of stocks from the same region.  Stock units represented in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> were chosen based on the level of management interest, their contribution to <span title = "PFMC: Pacific Fishery Management Council">PFMC</span> fisheries, and the availability of representative coded wire tag (CWT) recoveries in the Regional Mark Information System (<a title = "RMIS" href = "https://www.rmpc.org/" target = "_blank">RMIS</a>).  Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes a comprehensive set of stocks originating from Central California to Southeast Alaska and is considered to represent total West Coast production. For coho, only age three fish are included in the model.

## 1.2. Fisheries

The <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes pre-terminal and terminal fisheries in southeast Alaska, Canada, Puget Sound, and off the coasts of Washington, Oregon, and California.  There are 198 fisheries in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> A unique fishery identification number and fishery name for each of the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries are listed in **Appendix 3**. Terminal fisheries in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> include individual freshwater fisheries. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can model directed fisheries, mark-selective fisheries, and non-retention fisheries, and also calculates fisheries-related incidental mortalities. 

## 1.3. Time Steps

The time step structure used in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> represents a level of resolution that corresponds to data availability, fishery management structure, and species-specific migration and maturation schedules. Recoveries of <span title = "CWT: Coded wire tag">CWTs</span> for each stock unit during years with widespread tagging and fisheries (the reference base period, explained further in **Section 3**) are used to estimate model parameters such as exploitation rates. The amount of recovery data available by stock unit and fishery in the historical <span title = "CWT: Coded wire tag">CWT</span> database limit the time-step resolution of the model.  Decreasing the number of <span title = "CWT: Coded wire tag">CWT</span> recoveries in a time step by making the time step shorter can increase the variance of the estimated parameters in those strata.  In recognition of these data limitations, efforts were made to restrict the level of time step resolution to that necessary for fishery management purposes.

At each time step, a stock experiences natural mortality, and can be subjected to pre-terminal fisheries, and terminal fisheries. 

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> contains five time periods for coho, covering a single calendar year (**Appendix Table 5**).  

Table 1. Time step structure used in Coho FRAM.
```{r calcs_data_coho_t1_timesteps, echo=FALSE}
dplyr::tibble(
  `Time Step` = c(1:5),
  Months = c("January - June", "July", "August", "September", "October - December")
  ) |> gt::gt()
```

<br>

## 1.4. Assumptions and Limitations

*Major assumptions and limitations of the model are briefly described below.*

**<span title = "CWT: Coded wire tag">CWT</span> fish accurately represent the modeled stock.**  Many <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> stocks are aggregates of stocks that are represented by <span title = "CWT: Coded wire tag">CWTs</span> from only one production type, usually hatchery origin.  For example, in nearly all cases wild/natural stocks are aggregated with hatchery stocks and both are represented by the hatchery stock’s <span title = "CWT: Coded wire tag">CWT</span> data.  Therefore, for each modeled stock aggregate, it is assumed that the tagged and untagged fish are distributed and exploited at the same rates.

**Each stock unit and age class is exploited as a single pool.** All pre-terminal fisheries operate on the entire cohort simultaneously in each time step, and all terminal fisheries operate on the mature run.

**Natural mortality is constant from year to year.** Natural mortality is assumed to be constant across months for all stocks.  

**Stock distribution and migration is constant from year to year and is represented by the average distribution of <span title = "CWT: Coded wire tag">CWT</span> recoveries during the reference base period.**  We currently lack data on the annual variability in distribution and migration patterns of Chinook and coho salmon stocks.  In the absence of such estimates, fishery-specific exploitation rates are computed relative to the entire cohort.

# 2. Model Parameterization

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> data are stored as tables in an ACCESS database. All the information needed for a “simple model run” (link to chapter in user manual) is stored in these tables, containing input as well as output data. Input data can be grouped into two main categories: static base period data and annual run data (see **section 3.1**). Main <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> outputs are mortalities (landed, mark-selective, sublegal, non-retention, drop-off) and abundances (starting cohorts at each time step; abundances after natural mortalities, pre-terminal, and terminal fisheries).

## 2.1. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> Input Data

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> input data consist of two main input types: base period reference data and annual data.  Base period data remain constant until a new base period replaces the existing one.  The principal base period inputs are stock-fishery specific exploitation rates.  Other base period parameters include base period catches and cohort sizes.  The second input type consists of annual data that can vary with each model run, such as stock specific abundance estimates, fishery catches, size limits, etc.  

## 2.2. Base Period Data

<span title = "CWT: Coded wire tag">CWT</span> recoveries are used to estimate model parameters such as time/area/fishery exploitation rates and maturation rates for modeled stocks.  The years from which <span title = "CWT: Coded wire tag">CWT</span> recoveries are used to estimate these parameters are referred to as the reference "base period."  These parameter estimates are derived through species-specific cohort analyses.  Each cohort analysis is a series of procedures that use <span title = "CWT: Coded wire tag">CWT</span> recoveries and base period catch and escapement data to “back-calculate,” or reconstruct, a pre-fishing cohort size for each stock using assumed natural mortality and incidental mortality rates.  See (Model Evaluation Workgroup, 2008) for a more detailed description of the cohort analysis procedures.

Model base period data for the Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> is derived from fishery and escapement recoveries of <span title = "CWT: Coded wire tag">CWTs</span> and terminal area run size estimates for the return years 1986-1992 (Packer et al. 2007).  In 2006, the previously used base period data from 1986-1991 were re-analyzed, changes were made to the algorithm, and 1992-1997 catch year data were compiled.  A decision was made to only incorporate the 1992 catch year with the previous base period data, and thus the coho base period for return years 1986-1992 was generated.

## 2.3. Annual Data

Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> uses five general types of input.  Three of these input types (<span title = "a. Cohort abundance; b. Fishery landed catch; d. Mark-selective fisheries">a, b, d</span>) are submitted annually to reflect projected stock abundances and proposed fishery regulations for the current model year.  The remaining two types of input (<span title = "c. Release-mortality rates; e. Other non-landed mortality rates">c, e</span>) are specifications for fishery-related mortalities that can change as more information becomes available through additional data collection or studies, but typically do not change annually.

**a.** *Cohort Abundance*:  For each stock unit, an annual abundance is obtained from a source that is independent of the model, typically in the form of an ocean age-3 run size (pre-fishing age-3 abundance in the ocean after natural mortality has been subtracted).  In a pre-season context these abundances come from annual forecasts, whereas in a post-season context the abundances are derived from estimates of actual returns. For coho, an initial stock abundance is needed for adult fish (age-3) by mark status.  

**b.** *Fishery Landed Catch*:  The model provides three options for setting the catch in a fishery: a quota, a fishery scaler, and a harvest rate (for Puget Sound and Washington coastal terminal fisheries). 

<u>Quota</u>:  Catch in the fishery is set equal to a numeric value input by the user.<br>
<u>Fishery Scaler</u>:  The fishery is scaled relative to the effort during the reference base period using a scaler value input by the user.  
<u>Harvest rate</u>:  Using the Puget Sound <span title = "TAMM: Terminal Area Management Module">TAMM</span>, a terminal area harvest rate can be applied to terminal area fisheries.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> inputs for quota and fishery scaler can be identified as either a conventional retention fishery or a mark-selective fishery and modeled accordingly.  Modeling as a mark-selective fishery initiates additional calculations to estimate catches, encounters, and mortalities differently for marked and unmarked groups.

**c.** *Release Mortality Rates*:  This is the mortality associated with the release of landed fish from hook-and-line and other gear types. Release mortality rates are designated by species, geographic area, fishery type and gear type (Appendix 6). Release mortality is assessed when coho are not retained (“non-retention” or CNR fisheries) as well as in mark-selective fisheries. A number of studies have estimated release mortality for hook-and-line fisheries, and release mortality rates for troll and recreational fisheries in the ocean have been formally adopted by the <span title = "PFMC: Pacific Fishery Management Council">PFMC</span>. Release mortality in net fisheries with non-retention is estimated externally to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and provided as an input to the model.

**d.** *Mark-selective fisheries* have two additional variations of “release” mortality that are described as either the inappropriate retention of an unmarked fish or the release of a marked fish that consequently experiences release mortality.  The failure to release an unmarked fish is a user input to the model called “<u>Unmarked Retention Error</u>” (or Retention Error Rate) and is the proportion of the unmarked fish encountered that are retained.  The release of marked fish is a user input to the model called “<u>Marked Recognition Error</u>” and it is the proportion of the marked fish encountered that are released; these released marked fish are then subject to release mortality.  These rates are updated annually based on fishery monitoring data. 

**e.** *Other Non-landed Mortality Rates*:  This includes fishing-induced mortality not associated with directly handling fish.  Drop-off mortality occurs when fish in sport and troll hook-and-line fisheries drop off the hook before they are brought to the vessel yet die from hook injuries.   Drop-out mortality occurs when fish in commercial net fisheries are not brought on board but die from injury as a result of being netted.  For simplicity, both types are referred to as drop-off mortality in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>.  Net drop-out mortality rates vary depending on species, net type, or timing (pre-terminal or terminal) of the fishery.  In general, a 5% drop-off mortality rate is applied to the landed catch to account for “other non-landed mortalities” in hook-and-line fisheries (see **Appendix 6**).

# 3. Model Calculations 

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>  processes information through a time step loop, beginning with time step 1 and ending with time step 5 for coho.  Within each time step, a series of four computational processes occur for each stock as depicted in Figure 1: (**1**) determine starting cohort size, (**2**) removal of natural mortality, (**3**) removal of pre-terminal mortalities, (**4**) removal of terminal fishery mortalities (time 5 only).

```{r coho flow chart image, echo=FALSE}
knitr::include_graphics(c("images/Coho_FRAM_flowchart.PNG"))
```

Figure 1.  Conceptual flow chart for the Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model.

## 3.1. Cohort Abundance

<u>Process 1:  Cohort Abundance at the Start of the Time Step</u>

The starting cohort size in time step 1 is a product of two parameters: (*1*) the base period cohort size for stock *s* at age 3 in the first time period (<span title = "Base period cohort abundance estimate of stock s at age 3">$BPCohorts_{s,a \! = \! 3}$</span>) and (*2*) a stock and age-specific scaler (<span title = "Stock recruit scaler of stock s at age 3">$StockScalers_{s,a \! = \! 3}$</span>).  The scaler is an annual model input. 

<p>**(1)**<div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 during time step 1">$Cohort_{s,a \! = \! 3,t\!=\!1}$</span> $=$ <span title = "Base period abundance of stock s at age 3">$BPCohort_{s,a \! = \! 3}$</span> $\times$ <span title = "Stock recruit scaler of stock s at age 3">$StockScaler_{s,a \! = \! 3}$</span> </div> </p>
where <span title = "Cohort abundance of stock s at age 3 during time step 1">$Cohort_{s,a \! = \! 3,t\!=\!1}$</span> is the initial cohort size for stock *s*, age 3, during time step *t*=1.

Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> only models age-3 fish (*a*=3). The starting cohort size is the projected number of age-3 fish in January of the fishing year for each stock.  All coho escape in the final time step (*t*=5) and thus are not aged in the model.

## 3.2. Natural Mortality 

<u>Process 2: Natural mortality during each time step</u> <br>

During each time step, the stock-age cohort size at the start of the time step is decreased to account for natural mortality:

<p>**(2)** <div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Discrete natural mortality rate at age a and time step t">$(1-M_{a,t})$</span> </div> </p>

where <span title = "Discrete natural mortality rate at age 3 and time step t">$M_{a \! = \! 3,t}$</span> is the discrete natural mortality rate for age 3 fish during time step *t* (Appendix 8).

## 3.3. Pre-terminal Fishery Mortality

<u>Process 3: Pre-terminal Fishery Mortality</u>

The remaining cohort is then subjected to removals by pre-terminal fisheries; both landed catch and non-landed mortalities associated with each fishery are calculated.  <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> simulates fishery mortalities using different processes depending upon the type of fishery: retention fishery (non-selective), non-retention fishery, or mark-selective fishery. 

<u>*3a.* In regular retention fisheries (non-selective), landed catch is estimated by:</u>