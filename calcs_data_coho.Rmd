---
title: "Coho Calculations"
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE, results = 'hide', warning = FALSE, message = FALSE}
#knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.height=12, fig.width=12)
```

# 1. Coho Model Structure

## 1.1. Stocks

Currently, 123 <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Stock" target = "_blank" title = "Stock">stock</a> groups are represented in Coho <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Fishery_Regulation_Assessment_Model_(FRAM)" target = "_blank" title = "FRAM: Fishery Regulation Assessment Model">FRAM</a>. Each of these stock groups have both <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Marked" target = "_blank" title = "marked">marked</a> (adipose fin clipped) and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Unmarked" target = "_blank" title = "Unmarked">unmarked</a> components to permit assessment of mark-selective fishery regulations; therefore, the current version of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> has a total of 246 stock units (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_1_Coho_FRAM_stocks" target = "_blank" title = "Appendix 1">Appendix 1</a>).  Model stocks may represent an individual salmon stock or an aggregate of stocks from the same region.  Stock units represented in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> were chosen based on the level of management interest, their contribution to <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pacific_Fishery_Management_Council_(PFMC)" target = "_blank" title = "PFMC: Pacific Fishery Management Council">PFMC</a> fisheries, and the availability of representative coded-wire tag (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Coded-Wire_Tag_(CWT)" target = "_blank" title = "CWT: Coded-wire tag">CWT</a>) recoveries in the Regional Mark Information System (<a title = "RMIS: Regional Mark Information System" href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Regional_Mark_Information_System_(RMIS)" target = "_blank">RMIS</a>).  Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes a comprehensive set of stocks originating from Central California to Southeast Alaska and represents total West Coast production. For Coho, only age three fish are included in the model.

## 1.2. Fisheries

The <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> includes <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pre-terminal_Fishery" target = "_blank" title = "Pre-terminal fishery">pre-terminal</a> and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Fishery" target = "_blank" title = "Terminal fishery">terminal fisheries</a> in southeast Alaska, Canada, Puget Sound, and off the coasts of Washington, Oregon, and California.  There are 198 fisheries in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>. A unique fishery identification number and fishery name for each of the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries are listed in <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_3_Coho_FRAM_fisheries" target = "_blank" title = "Appendix 3">Appendix 3</a>. Terminal fisheries in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> include individual freshwater fisheries. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can model <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Directed_Fishery" target = "_blank" title = "Directed fishery">directed fisheries</a>, mark-selective fisheries, and non-retention fisheries, and also calculates fisheries-related <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Incidental_Mortality" target = "_blank" title = "Incidental mortality">incidental mortalities</a>. 

## 1.3. Time Steps

The <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Time_Step" target = "_blank" title = "Time step">time step</a> structure used in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> represents a level of resolution that corresponds to data availability, fishery management structure, and species-specific migration and maturation schedules. Recoveries of <span title = "CWT: Coded wire tag">CWTs</span> for each stock unit during years with widespread tagging and fisheries (the reference <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Base_Period" target = "_blank" title = "Base period">base period</a>, explained further in **Section 3**) are used to estimate model <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Parameter" target = "_blank" title = "Parameter">parameters</a> such as exploitation rates. The amount of recovery data available by stock unit and fishery in the historical <span title = "CWT: Coded wire tag">CWT</span> database limit the time-step resolution of the model.  Decreasing the number of <span title = "CWT: Coded wire tag">CWT</span> recoveries in a time step by making the time step shorter can increase the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Variance" target = "_blank" title = "Variance">variance</a> of the estimated parameters in those strata.  In recognition of these data limitations, efforts were made to restrict the level of time step resolution to that necessary for life history fishery management purposes.

At each time step, a stock experiences <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Natural_Mortality" target = "_blank" title = "Natural mortality">natural mortality</a>, and can be subjected to pre-terminal fisheries, and terminal fisheries. 

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> contains five time periods for Coho, covering a single calendar year (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_5_Time_step_structure_used_in_coho_and_Chinook_FRAM_modeling" target = "_blank" title = "Appendix 5">Appendix 5</a>).  

Table 1. Time step structure used in Coho FRAM.

```{r calcs_data_coho_t1_timesteps, echo=FALSE}
dplyr::tibble(
  `Time Step` = c(1:5),
  Months = c("January - June", "July", "August", "September", "October - December")
  ) |> gt::gt()
```

<br>

# 2. Assumptions and Limitations

*Major assumptions and limitations of the model are briefly described below.*

**<span title = "CWT: Coded wire tag">CWT</span> fish accurately represent the modeled stock.**  Many <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> stocks are represented by <span title = "CWT: Coded wire tag">CWTs</span> from only one production type, usually hatchery origin.  For example, in nearly all cases wild/<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Natural" target = "_blank" title = "Natural">natural</a> stocks were aggregated in the base period with <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Hatchery" target = "_blank" title = "Hatchery">hatchery</a> stocks and both are represented by the hatchery stock’s <span title = "CWT: Coded wire tag">CWT</span> data.  Therefore it is assumed that the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Tagged" target = "_blank" title = "Tagged">tagged</a> and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Untagged" target = "_blank" title = "Untagged">untagged</a> fish are distributed and exploited at the same rates.

**Each stock unit and age class is exploited as a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Single_Pool_Model" target = "_blank" title = "Single pool model">single pool</a>.** All pre-terminal fisheries operate on the entire cohort simultaneously in each time step, and all terminal fisheries operate on the mature run.

**Natural mortality only varies by time step and is constant between stocks and from year to year.** 

**Release mortality and drop-off rates are fishery and time step specific and constant between stocks and from year to year.** Note: Mortality rates can be updated, but this is done very infrequently, i.e., only a few rates have been updated in the past 30 years.

**Stock distribution and migration is constant from year to year and is represented by the average distribution of <span title = "CWT: Coded wire tag">CWT</span> recoveries during the reference base period.**  We currently lack data on the annual variability in distribution and migration patterns of Chinook and coho salmon stocks.  In the absence of such estimates, fishery-specific exploitation rates are computed relative to the entire cohort.

# 3. Model Parameterization

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> data are stored as tables in a Microsoft Access database. All the information needed for a “simple model run” (<a href = "https://framverse.github.io/fram_doc/user_basic_forward_run.html" target = "_blank" title = "User Manual: Basic Forward Run">User Manual</a>) is stored in these tables, containing input as well as output data. Input data can be grouped into two main categories: static base period data and annual run data. Main <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> outputs are mortalities (landed, mark-selective, non-retention, drop-off) and abundances (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Starting_Cohort" target = "_blank" title = "Starting cohort">starting cohorts</a> at each time step; abundances after natural mortalities, pre-terminal, and terminal fisheries).

Table 2. Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> Microsoft Access Database Tables.

```{r coho database tables, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/Coho_FRAM_database_tables.PNG"))
```

## 3.1. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> Input Data

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> input data consist of two main input types: base period reference data and annual data.  Base period data remain constant until a new base period replaces the existing one.  The principal base period inputs are stock-fishery-time step specific exploitation rates.  Other base period parameters include base period catches and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Cohort_Size" target = "_blank" title = "Cohort size">cohort sizes</a>.  The second input type consists of annual data that can vary with each model run, such as stock specific abundance estimates, fishery catches, <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Size_Limit" target = "_blank" title = "Size limit">size limits</a>, etc.  

### 3.1.1. Base Period Data

<span title = "CWT: Coded wire tag">CWT</span> recoveries are used to estimate model parameters such as time/area/fishery exploitation rates.  The years from which <span title = "CWT: Coded wire tag">CWT</span> recoveries are used to estimate these parameters are referred to as the reference "base period."  These parameter estimates are derived through stock-specific <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Cohort_Analysis" target = "_blank" title = "Cohort analyses">cohort analyses</a>.  Each cohort analysis is a series of procedures that use <span title = "CWT: Coded wire tag">CWT</span> recoveries and base period catch and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Escapement" target = "_blank" title = "Escapement">escapement</a> data to “back-calculate,” or reconstruct, a pre-fishing cohort size for each stock using assumed natural mortality and incidental mortality rates.  See (Model Evaluation Workgroup, 2008) for a more detailed description of the cohort analysis procedures.

Model base period data for the Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> is derived from fishery and escapement recoveries of <span title = "CWT: Coded wire tag">CWTs</span> and terminal area run size estimates for return years 1986-1992 (Packer et al. 2007).  In 2006, the previously used base period data from 1986-1991 were re-analyzed, changes were made to the algorithm, and 1992-1997 catch year data were compiled.  A decision was made to only incorporate the 1992 catch year with the previous base period data, and thus the Coho base period for return years 1986-1992 was generated.

If modeled fishery impacts for a stock deviate significantly from regulatory expectations or an analysis of <span title = "CWT: Coded Wire Tag">CWT</span> data is re-examined, a stock fishery rate scaler can be used for individual stocks within a fishery and time step to deviate from the reference base period. The stock fishery rate scaler is optional, must be agreed-to, and can be tied to an individual annual fishery input or remain as a static input to adjust the reference base period exploitation rate for a stock-fishery-time step.

### 3.1.2. Annual and Semi-static Data

These data are comprised of five general types of input.  Three of these input types (<span title = "a. Cohort abundance; b. Fishery landed catch; d. Mark-selective fisheries">a, b, d</span>) are submitted annually to reflect projected stock abundances and proposed fishery regulations for the current model year.  The remaining two types of input (<span title = "c. Release-mortality rates; e. Other non-landed mortality rates">c, e</span>) are specifications for fishery-related mortalities that can change as more information becomes available through additional data collection or studies, but typically do not change annually.

**a.** *Cohort Abundance*:  For each stock unit, an annual abundance is obtained from a regional expert, typically in the form of an ocean age-3 run size (pre-fishing age-3 abundance in the ocean after natural mortality has been subtracted).  In a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Pre-season" target = "_blank" title = "Pre-season">pre-season</a> context these abundances come from annual forecasts, whereas in a <a href = https://framverse.github.io/fram_doc/calcs_glossary.html#Post-season" target = "_blank" title = "Post-season">post-season</a> context the abundances are derived from estimates of actual returns. For Coho, an initial stock abundance is needed for adult fish (age-3) by mark status.  

**b.** *Fishery Landed Catch*:  The model provides three options for setting the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Landed_Catch" target = "_blank" title = "Landed catch">catch</a> in a fishery: a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Quota" target = "_blank" title = "Quota">quota</a>, a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Fishery_Scaler" target = "_blank" title = "Fishery scaler">fishery scaler</a>, and a <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Harvest_Rate_(HR)" target = "_blank" title = "HR: Harvest rate">harvest rate</a> (for Puget Sound and Washington coastal terminal fisheries). 

<u>Quota</u>:  Catch in the fishery is set equal to a numeric value input by the user.<br>
<u>Fishery Scaler</u>:  The fishery is scaled relative to the effort during the reference base period using a scaler value input by the user. The catch resulting from a scaler is a function of the base period exploitation rates and stock abundances.  
<u>Harvest Rate</u>:  Using the Puget Sound <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Area_Management_Module_(TAMM)" target = "_blank" title = "TAMM: Terminal Area Management Module">TAMM</a>, a terminal area harvest rate can be applied to terminal area fisheries (time step 4 and 5). In the Coho <span title = "TAMM: Terminal Area Management Module">TAMM</span>, the terminal run size definitions can be customized (using the TAAETERSList table in the Microsoft Access database) and must be aligned with calculations used for each model input. For a list of terminal fisheries see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_3_Coho_FRAM_fisheries" target = "_blank" title = "Appendix 3: Coho FRAM fisheries">Appendix 3</a>.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> inputs for quota and fishery scaler can be identified as either a conventional retention fishery or a mark-selective fishery and modeled accordingly.  Modeling as a mark-selective fishery initiates additional calculations to estimate catches, <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Encounter" target = "_blank" title = "Encounter">encounters</a>, and mortalities differently for marked and unmarked groups.

**c.** *Release Mortality Rates*:  This is the mortality associated with the release of landed fish from hook-and-line and other gear types. Release mortality rates are designated by species, geographic area, fishery type and gear type (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_6_FRAMTAMM_fishery-related_mortality_rates_for_coho_salmon_(version_used_in_2021_pre-season_planning_models)" target = "_blank" title = "Appendix 6"</a>). Release mortality is assessed when Coho are not retained (“non-retention” or <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#ChinookCoho_Non-retention_(CNR)_Fisheries" target = "_blank" title = "CNR: Coho non-retention">CNR fisheries</a>) as well as in mark-selective fisheries. A number of studies have estimated release mortality for hook-and-line fisheries, and release mortality rates for <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Troll_Fishery" target = "_blank" title = "Troll fishery">troll</a> and <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Recreational_Fisheries" target = "_blank" title = "Recreational fisheries">recreational fisheries</a> in the ocean have been formally adopted by the <span title = "PFMC: Pacific Fishery Management Council">PFMC</span>.

Release mortality in the majority of net fisheries with non-retention is estimated externally to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> using agreed-to rates.

**d.** *Mark-selective fisheries* have two additional variations of “release” mortality that are described as either the inappropriate retention of an unmarked fish or the release of a marked fish that consequently experiences release mortality.  The failure to release an unmarked fish is a user input to the model called “<u>Unmarked Retention Error</u>” (<span title = "Unmarked retention error">$ure$</span>, or <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Unmarked_Retention_Error_Rate" target = "_blank" title = "Unmarked retention error rate">Retention Error Rate</a>) and is the proportion of the unmarked fish encountered that are retained.  The release of marked fish is a user input to the model called “<u><a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Marked_Recognition_Error_Rate" target = "_blank" title = "Marked recognition error rate">Marked Recognition Error</a></u>” (<span title = "Marked Recognition Error">$mre$</span>) and it is the proportion of the marked fish encountered that are released; these released marked fish are then subject to release mortality.  These rates are updated annually based on fishery monitoring data. 

**e.** *Other Non-landed Mortality Rates (Incidental Rates)*:  This includes fishing-induced mortality not associated with directly handling fish.  <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Drop-off_Mortality" target = "_blank" title = "Drop-off mortality">Drop-off mortality</a> can occur when fish in sport and troll hook-and-line fisheries drop off the hook before they are brought to the vessel. <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Drop-out_Mortality" target = "_blank" title = "Drop-out mortality">Drop-out mortality</a> occurs when fish in commercial net fisheries are not brought on board but die from injury as a result of encountering the net.  For simplicity, both types are referred to as drop-off mortality in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>.  Net drop-out mortality rates vary depending on species, net type, or timing (pre-terminal or terminal) of the fishery.  In general, a 5% drop-off mortality rate is applied to the landed catch to account for “other <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Non-landedNon-retention_Mortality" target = "_blakn" title = "Non-landed mortality">non-landed mortalities</a>” in hook-and-line fisheries (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_6_FRAMTAMM_fishery-related_mortality_rates_for_coho_salmon_(version_used_in_2021_pre-season_planning_models)" target = "_blank" title = "Appendix 6">Appendix 6</a>).

# 4. Model Calculations 

<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

## 4.1. Overview

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>  processes information through a time step loop, beginning with time step 1 and ending with time step 5 for Coho.  Within each time step, a series of four computational processes occur for each stock as depicted in Figure 1: (**1**) calculate starting cohort size, (**2**) remove natural mortality, (**3**) remove pre-terminal mortalities, (**4**) remove terminal fishery mortalities (time 5 only).

```{r coho flow chart image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/Coho_FRAM_flowchart.PNG"))
```

Figure 1.  Conceptual flow chart for the Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model.

## 4.2. Computational Processes

**Cohort Abundance**

<u>Process 1:  Cohort Abundance at the Start of the Time Step</u>

The starting cohort size in time step 1 is a product of two parameters: (*1*) the base period cohort size for stock *s* at age 3 in the first time period (<span title = "Base period cohort abundance estimate of stock s at age 3">$BPCohorts_{s,a \! = \! 3}$</span>) and (*2*) a stock and age-specific scaler (<span title = "Stock recruit scaler of stock s at age 3">$StockScalers_{s,a \! = \! 3}$</span>).

Pre-season, the starting cohort is generally calculated from forecasts of ocean age-3 (<span title = "Ocean Age-3">OA3</span>) abundances. These forecasts are expanded for natural mortalities by multiplying OA3 * 1.2315 to arrive at January age-3 (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#January_Age-3_Abundance_(JA3)" target = "_blank" title = "JA3: January age-3 abundance">JA3</a>) starting cohorts.

Post-season, the starting cohort is generally calculated by expanding escapement estimates for fisheries mortalities and natural mortalities during <span title = "BkFRAM: Backwards FRAM">BkFRAM</span> (see <a href = "https://framverse.github.io/fram_doc/calcs_data_coho.html#6_Backwards_FRAM" target = "_blank" title = "Chapter 6: Backwards FRAM">Backwards FRAM</span> chapter).

<p>**(1)**<div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 during time step 1">$Cohort_{s,a \! = \! 3,t\!=\!1}$</span> $=$ <span title = "Base period abundance of stock s at age 3">$BPCohort_{s,a \! = \! 3}$</span> $\times$ <span title = "Stock recruit scaler of stock s at age 3">$StockScaler_{s,a \! = \! 3}$</span> </div> </p>
where <span title = "Cohort abundance of stock s at age 3 during time step 1">$Cohort_{s,a \! = \! 3,t\!=\!1}$</span> is the initial cohort size for stock *s*, age 3, during time step *t*=1.

Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> only models age-3 fish (*a*=3). The starting cohort size is the projected number of age-3 fish in January (<span title = "JA3: January age-3 fish">JA3</span>) of the fishing year for each stock.  All Coho escape in the final time step (*t*=5) and thus are not aged in the model.

**Natural Mortality**

<u>Process 2: Natural mortality during each time step</u> <br>

During each time step, the stock-age cohort size at the start of the time step is decreased to account for natural mortality:

<p>**(2)** <div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Discrete natural mortality rate at age 3 and time step t">$(1-M_{a \! = \! 3,t})$</span> </div> </p>

where <span title = "Discrete natural mortality rate at age 3 and time step t">$M_{a \! = \! 3,t}$</span> is the discrete natural mortality rate for age 3 fish during time step *t* (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_8_Time_period_and_age-specific_rates_used_by_FRAM_to_simulate_coho_and_Chinook_natural_mortality" target = "_blank" title = "Appendix 8">Appendix 8</a>).

**Pre-terminal Fishery Mortality**

<u>Process 3: Pre-terminal Fishery Mortality</u>

The remaining cohort is then subjected to removals by pre-terminal fisheries; both landed catch and non-landed mortalities associated with each fishery are calculated. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> simulates fishery mortalities using different processes depending upon the type of fishery: retention fishery (non-selective), non-retention fishery, or mark-selective fishery. 

<u>**3a.** In regular retention fisheries (non-selective), landed catch is estimated by:</u>

<p>**(3)**<div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 in fishery f during time step t">$Catch_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Base period exploitation rate for stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Fishery scaler for fishery f during time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Portion vulnerable of stock s at age 3 in fishery f during time step t">$PV_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Stock fishery rate scaler for stock s in fishery f during time step t">$SHRF_{s,f,t}$</span> </div> </p>

where:

- <span title = "Base period exploitation rate for stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> is the base period exploitation rate for stock *s*, at age 3, in fishery *f*, during time step *t*.
- <span title = "Fishery scaler for fishery f during time step t">$FisheryScaler_{f,t}$</span> is an annual model input that relates effort in the model year back to the effort during the base period.
- <span title = "Portion vulnerable of stock s at age 3 in fishery f during time step t">$PV_{s,a \! = \! 3,f,t}$</span> is the portion of the stock cohort *s*, at age 3, during time step *t* that is of legal size in fishery *f* (i.e. portion vulnerable; <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Proportion_Vulnerable_(PV)" target = "_blank" title = "PV: Proportion vulnerable">PV</a>). For coho, <span title = "PV: Portion vulnerable">PV</span> is always 1 and can be eliminated from the equation.
- <span title = "Stock fishery rate scaler for stock s in fishery f during time step t">$SHRF_{s,f,t}$</span> is the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Stock_Fishery_Rate_Scaler_(SHRF)" target = "_blank" title = "SHRF: Stock Fishery Rate Scaler">stock fishery rate scaler</a> for stock *s* in fishery *f* during time step *t*. The <span title = "Stock fishery rate scaler">$SHRF$</span> is optional and can be used to adjust impacts for individual stocks in a fishery and time step; i.e., if <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output for an individual stock significantly deviates from expectations, then the user can make adjustments by providing a <span title = "Stock fishery rate scaler">$SHRF$</span> scaler. The stock fishery rate scaler was conceived to adjust the base period exploitation rate without the need to conduct a full calibration.

The <span title = "Fishery scaler for fishery f during time step t">$FisheryScaler_{f,t}$</span> is the foundation for the fishery simulation algorithms. <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> can evaluate two general types of fisheries: effort-based or catch-based. For effort-based fisheries, the <span title = "Fishery scaler for fishery f during time step t">$FisheryScaler_{f,t}$</span> is specified by the user to reflect expected effort during the model year relative to the average effort observed during the base period. For catch-based fisheries, the <span title = "Fishery scaler for fishery f during time step t">$FisheryScaler_{f,t}$</span> is computed by <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> to obtain a user-specified catch level (i.e. a quota).

<u>**3b.** Drop-off mortalities are estimated</u> by multiplying either **a**) landed catch in a non-selective retention fishery, or **b**) total encounters in a mark-selective fishery, by a user-specified drop-off mortality rate (<span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span> see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_6_FRAMTAMM_fishery-related_mortality_rates_for_coho_salmon_(version_used_in_2021_pre-season_planning_models)" target = "_blank" title = "Appendix 6">Appendix 6</a>)

**a)** Non-selective retention fishery *f*:
<p>**(4a)**<div style = "text-align:center"><span title = "Drop-off mortality of stock s at age 3 in fishery f at time step t">$Dropoff_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Landed catch of stock s at age 3 in fishery f during time step t">$Catch_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span> </div> </p>
**b)** Mark-selective fishery *f*:
<p>**(4b)**<div style = "text-align:center"><span title = "Drop-off mortality of stock s at age 3 in fishery f at time step t">$Dropoff_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Number of encounters of stock s at age 3 in fishery f during time step t">$Encounters_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Drop-off mortality rate of fishery f">$DropRate_f$</span></div></p>

<u>**3c.** Coho non-retention (CNR) mortalities are estimated</u> for time periods when fishing is allowed, but the retention of Coho is prohibited.

Non-retention mortalities are calculated external to the model, often derived using historical observations, and are model inputs in units of dead age-3 fish <span title = "Estimated coho non-retention mortalities in fishery f during time step t">$(EstCNRMorts_{f,t})$</span>. Non-retention mortalities by stock are then calculated in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> by multiplying the total non-retention mortality by the stock proportion <span title = "Proportion of stock present">$(PropCatch)$</span>.

<p>**(5)**<div style = "text-align:center"><span title = "Coho non-retention mortalities of stock s in fishery f during time step t">$CNR_{s,f,t}$</span> $=$ <span title = "Estimated coho non-retention mortalities in fishery f during time step t">$EstCNRMorts_{f,t}$</span> $\times$ <span title = "Proportion present of stock stock s in fishery f during time step t">$PropCatch_{s,f,t}$</span> </div> </p>

<u>**3d.** Mark-selective fisheries</u> (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Mark-selective_Fishery_(MSF)" target = "_blank" title = "MSF: Mark-selective fishery">MSF</a>) require additional computations to calculate both the landed catch and the mortalities due to the release of fish.

To simplify calculations, the <span title = "SHRS: Stock fishery rate scaler">SHRS</span> is excluded from the below calculations:

For **marked stock** units, the landed catch is calculated using an additional term to account for marked-recognition error (the release of a marked fish) and is fishery and time step specific <span title = "Marked-recognition error in fishery f during time step t">$(mre_{f,t})$</span>:

<p>**(6a)**<div style = "text-align:center"><span title = "Mark-selective fishery catch of stock s at age 3 in fishery f during time step t">$MSFCatch_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Base period exploitation rate of stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times (1 \ -$ <span title = "Marked-recognition error in fishery f during time step t">$mre_{f,t})$</span> </div> </p>

For **unmarked stock** units, the landed catch is calculated using an additional term to account for unmarked retention error (retaining an unmarked fish in a mark-selective fishery) and is fishery and time step specific <span title = "Unmarked retention error for fishery f during time step t">$(ure_{f,t})$</span>:

<p>**(6b)**<div style = "text-align:center"><span title = "Mark-selective fishery catch of stock s at age 3 in fishery f during time step t">$MSFCatch_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Base period exploitation rate of stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Unmarked-retention error for fishery f during time step t">$ure_{f,t}$</span> </div> </p>

Equations used to calculate adult release mortalities <span title = "Adult release mortalities">$(AdultRelMort)$</span> in mark-selective fisheries must account for marked recognition <span title = "Marked-recognition error">$(mre)$</span> and unmarked retention error <span title = "Unmarked retention error">$(ure)$</span> for marked and unmarked stock units and utilize fishery and time step-specific release mortality rates <span title = "Specific fishery mortality rate of fishery f during time step t">$(sfm_{f,t})$</span> (<a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_6_FRAMTAMM_fishery-related_mortality_rates_for_coho_salmon_(version_used_in_2021_pre-season_planning_models)" target = "_blank" title = "Appendix 6">Appendix 6</a>).

<p>**(7a) Marked:**<div style = "text-align:center"><span title = "Adult release mortalities of stock s at age 3 in fishery f during time step t">$AdultRelMort_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Base period exploitation rate for stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times$ <span title = "Marked recognition error in fishery f">$mre_f$</span> $\times$ <span title = "Specific release mortality rate of fishery f during time step t">$sfm_{f,t}$</span> </div> </p>

<p>**(7b) UnMarked:**<div style = "text-align:center"><span title = "Adult release mortalities of stock s at age 3 in fishery f during time step t">$AdultRelMort_{s,a \! = \! 3,f,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $\times$ <span title = "Base period exploitation rate for stock s at age 3 in fishery f during time step t">$BPER_{s,a \! = \! 3,f,t}$</span> $\times$ <span title = "Fishery scaler of fishery f at time step t">$FisheryScaler_{f,t}$</span> $\times (1 \ -$ <span title = "Unmarked retention error in fishery f">$ure_f)$</span> $\times$ <span title = "Specific release mortality rate of fishery f during time step t">$sfm_{f,t}$</span> </div> </p>

Drop-off mortalities in mark-selective fisheries are calculated by multiplying the drop-off mortality rate with the number of total encounters, as described in process 3b above.

<u>**3e.** All pre-terminal fishery mortalities</u> in time step *t* for stock *s* at age 3 are totaled <span title = "TotMort: Total pre-terminal fishery mortalities">$(TotMort)$</span> and the size of the cohort is reduced accordingly. Since the Coho model contains only age-3 mature fish, the summing of fishery mortalities occurs only once in each time step.

<p>**(8)**<div style = "text-align:center"><span title = "Total pre-terminal fishery mortalities for stock s at age 3 during time step t">$TotMort_{s,a \! = \! 3,t}$</span> $=$ <span title = "Summed over fishery f">$\displaystyle\sum_f$</span> <span title = "Landed catch of stock s at age 3 in fishery f during time step t">$(Catch_{s,a \! = \! 3,f,t}$</span> $+$ <span title = "Drop-off mortality of stock s at age 3 in fishery f at time step t">$Dropoff_{s,a \! = \! 3,f,t}$</span> $+$ <span title = "Adult release mortalities of stock s at age 3 in fishery f during time step t">$AdultRelMort_{s,a \! = \! 3,f,t}$</span> $+$ <span title = "Non-retention mortality of stock s at age 3 in fishery f during time step t">$CNR_{s,a \! = \! 3,f,t})$</span></div></p>

The remaining cohort is then calculated as:

<p>**(9)**<div style = "text-align:center"><span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step t">$Cohort_{s,a \! = \! 3,t}$</span> $-$ <span title = "Total pre-terminal fishery mortalities for stock s at age 3 during time step t">$TotMort_{s,a \! = \! 3,t}$</span> </div> </p>

Fisheries during time steps 1 through 4 are considered to be on <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Immature" target = "_blank" title = "Immature">immature</a> fish and, by default, all Coho fisheries in time step 5 are on mature fish.  Thus, 
<div style = "text-align:center"><span title = "Mature cohort abundance of stock s at age 3 during time step 5">$MatureCohort_{s,a \! = \! 3,t \! = \! 5}$</span> $=$ <span title = "Cohort abundance of stock s at age 3 during time step 5">$Cohort_{s,a \! = \! 3,t \! = \! 5}$</span>. </div>

<u>Process 4: Terminal Fishery Mortality</u>

Terminal fishery mortality is calculated for the mature cohort only, using the same equations as for pre-terminal fishery mortality.  Fishery mortalities are summed, and the remainder of the mature cohort constitutes the escapement from <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fisheries. Since only age-3 adult Coho are modeled and the mature time step is always 5, age and time step parameters can be eliminated from the equations.

<p>**(10)**<div style = "text-align:center"><span title = "Total terminal fishery mortality for stock s at age 3 during time step t">$TotTermMort_{s,a \! = \! 3,t \! = \! 5}$</span> $=$ <span class = "math" title = "Sum over terminal fishery f">$\displaystyle\sum_{f \in terminal}$</span> <span title = "Landed catch of stock s at age 3 in fishery f during time step 5">$(Catch_{s,a \! = \! 3,f,t \! = \! 5}$</span> $+$ <span title = "Drop-off mortality of stock s at age a in fishery f at time step t">$Dropoff_{s,a,f,t}$</span> $+$ <span title = "Adult release mortalities of stock s at age a in fishery f during time step t">$AdultRelMort_{s,a \! = \! 3,f,t \! = \! 5}$</span> $+$ <span title = "Non-retention mortality of stock s at age a in fishery f during time step t">$CNR_{s,a \! = \! 3,f,t \! = \! 5})$</span> </div> </p>

<p>**(11)**<div style = "text-align:center"><span title = "Escapement of stock s at age a during time step t">$Escapement_{s,a,t}$</span> $=$ <span title = "Mature cohort abundance of stock s at age a during time step t">$MatureCohort_{s,a,t}$</span> $-$ <span title = "Total terminal fishery mortality for stock s at age a during time step t">$TotTermMort_{s,a,t}$</span></div> </p>

Escapement is defined as the number of fish that remain in the mature cohort after removal of all terminal-area fishery related mortality. For coho modeling, which includes freshwater fisheries, escapement represents the adult spawning abundance if mortality during “pre-spawning” holding time is negligible.

<u> Process 5: <span title = "TAMM: Terminal Area Management Module">TAMM</span> Iterations</u>

For Coho, traditionally, the word "Terminal" has two meanings. It can either denote fisheries occurring on the mature cohort(see previous paragraph) or it can describe fisheries that occur in terminal marine areas (see <a href = "https://framverse.github.io/fram_doc/calcs_appendices.html#Appendix_3_Coho_FRAM_fisheries" target = "_blank" title = "Appendix 3: Coho FRAM fisheries">Appendix 3</a>). These fisheries occur in time step 4 and 5, are reported from <span title = "TAMM: Terminal Area Management Module">TAMM</span> to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>, and involve iterative solutions to calculate stock specific impacts. During a first pass, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> completes a run with the terminal fishery inputs stored in the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> database. These "seed" inputs usually stem from a previous model run. After this pass is completed, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> estimates terminal fishery impacts using values from <span title = "TAMM: Terminal Area Management Module">TAMM</span> and compares them to the original <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> results.  If these numbers are equal (less than 0.1% or fewer than 4 fish difference), the model is done.  If these numbers are not equal, an <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#TAMM_Iterations" target = "_blank" title = "TAMM iterations">iterative</a> process is initiated during which <span title = "TAMM: Terminal Area Management Module">TAMM</span> terminal fishery impacts are used to adjust <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> terminal fishery impacts until there is convergence (see <a href = "https://framverse.github.io/fram_doc/calcs_data_coho.html#5_Terminal_Area_Management_Module" target = "_blank" title = "Chapter 5">Chapter 5</a>).  

Finally, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> sends terminal marine and freshwater run sizes and fishing mortality to the <span title = "TAMM: Terminal Area Management Module">TAMM</span> file for use in additional calculations and final reporting.

## 4.3. Processing Schematic

To facilitate  understanding of the sequencing of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> processing steps, Table 3 provides an example of how a stock’s cohort is processed through time step from starting cohort to escapement.

The starting cohort in time step 1 is first reduced by natural mortality. The remaining cohort is vulnerable to pre-terminal fisheries. Coho not caught become the starting cohort of the next time step. This cycle repeats until time step 5, when 100% of Coho mature after pre-terminal fishing.  The mature cohort is susceptible to terminal fisheries. Coho not caught after pre-terminal and terminal fisheries in time step 5, go to escapement.

Table 3. Example values of Coho FRAM processing steps for a stock by time step.
```{r coho process schematic image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/Coho_FRAM_process_schematic.PNG"))
```

## 4.4. Exploitation Rate Calculation

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> calculates stock-specific mortalities and escapements that are ultimately used to compute exploitation rates (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Exploitation_Rate_(ER)" target = "_blank" title = "ER: Exploitation rate">ER</a>). Exploitation rate calculations are not part of the main <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> algorithms and are not calculated by <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>  Exploitation rates are computed from <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> or <span title = "TAMM: Terminal Area Management Module">TAMM</span> output as the sum of all fishery mortalities divided by fishery mortalities plus escapement.

**(12)**
<span title = "Exploitation rate of stock s equals the total mortality of stock s at age 3 summed over time steps over the sum of the total mortality of stock s at age 3 summed over time steps plus the escapement of stock s">$$ER_s = \frac{\displaystyle\sum\limits_{t} TotMort_{s,a \! = \! 3,t}}{\displaystyle\sum\limits_{t} TotMort_{s,a \! = \! 3,t} + Escapement_{s}}$$</span>

## 4.5. Bias Corrected Mark-Selective Fishery Equations for Coho

The total number of unmarked mortalities in <span title = "MSF: Mark-selective fishery">MSF<span> is underestimated by models relying on the linear relationship between exploitation rate and release-mortality rate.  The actual mortality rate of unmarked fish is an increasing function of the time step-specific exploitation rate.  When <span title = "MSF: Mark-selective fishery">MSFs</span> operate during a modeled time step, unmarked mortalities are underestimated because released fish may encounter the fishing gear more than once during the modeled time step and the unmarked-to-marked fish ratio for all fish in the pool increases during the time step as a result of the selective removal of marked fish in a mark-selective fishery.  See (Conrad, Hagen-Breaux, & Yuen, 2013) for a detailed description of the equations.

Bias adjusted exploitation rates for marked and unmarked stock units are calculated as:

<p>**(13)**<div style = "text-align:center"><span title = "Exploitation rate of stock s at time step t">$ER_{s,t}$</span> $= 1 - (1 -$ <span title = "Summed over fishery f">$\displaystyle\sum_f$</span><span title = "Marked exploitation rate of stock s in fishery f during time step t">$(ER_{s,f,t}^M$</span><span title = "Weighted release mortality rate of stock s during time step t">$)^{\delta_{s,t}^W})$</span></div></p>

**(14)**
<span title = "Weighted release mortality rate w for stock s at time step t is equal to f's marked exploitation rate of stock s at time step t over the sum of fishery f's marked exploitation rate of stock s at time step t multiplied by the release mortality rate of fishery f, summed over fishery f">
$$\delta_{s,t}^w = \sum_f \frac{ER_{s,f,t}^M}{\displaystyle\sum_f ER_{s,f,t}^M} \times \sfm_f$$ </span>

where:

- <span class = "math" title = "Marked exploitation rate for stock s in fishery f during time step t">$ER^M_{s,f,t}$</span> is the marked exploitation rate of stock *s* in fishery *f* during time step *t*
- <span title = "Release mortality rate in (MSF) fishery f">$\sfm_f$</span> is the release mortality rate in <span title = "MSF: Mark selective fishery">(MSF)</span> fishery *f*
- <span title = "Weighted release mortality rate of stock s during time step t">$\delta^W_{s,t}$</span> is the weighted release mortality rate for stock *s* during time step *t*
- <span title = "Marked exploitation rates summed over all fisheries for stock s during time step t">$\sum_f ER^M_{s,t}$</span> is the marked exploitation rates summed over fisheries for stock *s* at time step *t*

These exponential equations were implemented to estimate exploitation rates in Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> for stocks experiencing release in mark-selective fisheries during a given time step.

# 5. Terminal Area Management Module (<span title = "TAMM: Terminal Area Management Module">TAMM</span>)

The <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> program interacts with the <span title = "TAMM: Terminal Area Management Module">TAMM</span>, a species-specific Microsoft Excel file, which allows users to specify alternative terminal fishery inputs and to calculate impacts on a finer level of resolution than <span title = "FRAM: Fishery Regulation Assessment Model">FRAM.</span> The <span title = "TAMM: Terminal Area Management Module">TAMM</span> has separate sections for each of the six Puget Sound terminal regions defined in the Puget Sound Salmon Management Plan (PSSP 1985, Table 3) for the State of Washington and the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Treaty_Tribes" target = "_blank" title = "Treaty Tribes">Washington Treaty Indian Tribes of Puget Sound</a>, as well as Washington coastal terminal regions. This structure has supported development of unique regional management goals and allows managers the flexibility to analyze and report <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> model output according to their needs.

<span title = "TAMM: Terminal Area Management Module">TAMM</span> is best understood in its historic context as a terminal-area-centric fisheries model. Prior to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> development, information of stock-specific fishery impacts was not readily available. At that time, management was based on terminal run reconstructions that assigned 100% of terminal catches to only local terminal stocks. However, in the current model framework, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> takes <span title = "TAMM: Terminal Area Management Module">TAMM</span> fishery inputs and accounts for non-local and local stock impacts before reporting stock-specific impacts back to <span title = "TAMM: Terminal Area Management Module">TAMM</span>. Additionally, the <span title = "TAMM: Terminal Area Management Module">TAMM</span> also conducts alternative modeling for Washington coastal Coho stocks in terminal area fisheries, as well as generating inputs for Columbia River models. 

Table 4. Puget Sound Terminal Management Regions.
```{r coho terminal management regions table, echo = FALSE}
dplyr::tibble(
  `Management Regions` = c(
    "Nooksack-Samish", "Skagit", "Stillaguamish-Snohomish", 
    "South Sound", "Hood Canal", "Strait of Juan de Fuca")
) |> gt::gt()
```
<br>
Common <span title = "TAMM: Terminal Area Management Module">TAMM</span> features:

- Receive user inputs for <span title = "TAMM: Terminal Area Management Module">TAMM</span> terminal fisheries 
- Receive user input for <span title = "TAMM: Terminal Area Management Module">TAMM</span> stock management criteria (updated annually)
- Provide fishery inputs to <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> (time step 4 and 5) during <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span> iterations
- Receive <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output of fishery impacts and terminal abundances 
- Use <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> output to complete <span title = "TAMM: Terminal Area Management Module">TAMM</span> fishery impact modeling for Puget Sound and the Washington Coast
- Generate <span title = "TAMM: Terminal Area Management Module">TAMM</span> reports of combined <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and <span title = "TAMM: Terminal Area Management Module">TAMM</span> fishery impacts 


<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> iteratively finds the fishery scalers that produce the same catches <span title = "Catch calculated within FRAM">$(Catch_{FRAM})$</span> as those supplied by <span title = "TAMM: Terminal Area Management Module">TAMM</span> <span title = "Catch calculated within TAMM">$(Catch_{TAMM})$</span> in Puget Sound and Washington coastal fisheries (Figure 3).  <span title = "TAMM: Terminal Area Management Module">TAMM</span> catches are either input into the <span title = "TAMM: Terminal Area Management Module">TAMM</span> as catch values or <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Harvest_Rate_(HR)" target = "_blank" title = "HR: Harvest rate">harvest rates</a>. Harvest rates are multiplied by a unique terminal run size definition (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Terminal_Run_Size" target = "_blank" title = "TRS: Terminal run size">TRS</a>).  The <span title = "TRS: Terminal run size">TRS</span> for a <span title = "TAMM: Terminal Area Management Module">TAMM</span> region/stock represents ‘run-to-the-river’ of a stock plus catches of all stocks in the terminal fisheries designated for that region. In Coho <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span>, terminal run size definitions can be customized (using the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#TAAETRSList" target = "_blank" title = "TAAETRSList">TAAETRSList</a> table in the Microsoft Access database) and must be aligned with calculations used for each model input.

<span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> calculations for each terminal area:

During a first pass, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> completes a run with the terminal fishery inputs stored in the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> database. After the pass is completed:

- Sum escapements over appropriate time steps
- Add terminal catches <span title = "Catch calculated within FRAM">$(Catch_{FRAM})$</span> to calculate <span title = "TRS: Terminal run size">TRS</span> (includes non-local stocks)
- Calculate the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> fishery scaler that produces the <span title = "Catch calculated within TAMM">$Catch_{TAMM}$</span>:
<div style = "text-align:center"><span title = "Fishery scaler for a given area at a given time step">$FisheryScaler(area, time step)$</span> = <span title = "Catch calculated in TAMM for a given area at a given time step">$Catch_{TAMM}(area, time step)$</span> $\div$ <span title = "Catch calculated in FRAM for a given area at a given time step">$Catch_{FRAM}(area, time step)$</span> </div>
- Rerun <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> and repeat these steps until <span title = "Catch calculated within TAMM">$Catch_{TAMM}$</span> is within 0.1% (or fewer than 4 fish) of <span title = "Catch calculated within FRAM">$Catch_{FRAM}$</span>.

```{r coho FRAM TAMM flow chart image, echo=FALSE, out.width='100%'}
knitr::include_graphics(c("images/FRAM_TAMM_flowchart.PNG"))
```

Figure 3.  Conceptual flow chart for <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>-<span title = "TAMM: Terminal Area Management Module">TAMM</span> calculations.

# 6. Backwards <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span>

Backwards <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Backwards_FRAM_(BkFRAM)" target = "_blank" title = "Backwards FRAM">(BkFRAM)</a> is a utility that determines <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> starting cohorts when estimates of escapements  and fishery catches (landed and non-retention) are provided.  The program iteratively adjusts stock recruit scalers (a surrogate for starting cohorts, see equation below) and runs <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> forward until the resulting escapements match the target escapements. Starting cohorts are in units of January-age-3 adult fish. 

Post-season <span title = "bkFRAM: backwards FRAM">BkFRAM</span> runs are generally conducted to create the starting cohorts that result in observed escapements given known fishery catches. These cohorts are needed to calculate post-season exploitation rates.  

Working backwards from time step 5 to time step 1, for each time step, fishery and natural mortalities of a stock are added to the escapement target. Total mortalities are calculated by summing landed, drop-off, and non-retention mortalities over all fisheries for a stock and time step.
 
<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Mark_Selective_Fishing_Bias" target = "_blank" title = "Mark-selective fishing bias">Mark-selective fishery bias</a> correction calculations used for Coho produce an error when the exploitation rate exceeds 100%.  This frequently occurs during early iterations, because the abundances from the <a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#Seed_Run" target = "_blank" title = "Seed run">seed run</a> (usually the pre-season run) are not related to the post-season fishery catches (e.g., low pre-season forecasts but high post-season terminal catches).  To avoid errors, the first iteration initiates starting cohorts scaled 1000 times greater than the base period abundance.  Additionally, the first 7 iterations are run without bias correction to get sufficiently close to the target escapement, before adding mark-selective fishing bias calculations for all remaining iterations. 

<p>**(16)**<div style = "text-align:center"><span title = "Stock scaler of stock s at age 3">$StockScaler_{s,a \! = \! 3}$</span> $=$ <span title = "Backward FRAM target for stock s">$((((((BkTarget_s$</span> $+$ <span title = "Total mortality of stock s at age 3 during time step 5">$(TotMort_{s,a \! = \! 3,t \! = \! 5}$</span> $+$ <span title = "Total terminal mortality for stock s at age 3 during time step 5">$TotTermMort_{s,a \! = \! 3,t \! = \! 5})$</span> $\div (1 -$ <span title = "Discrete natural mortality at age 3 during time step 5">$M_{a \! = \! 3,t \! = \! 5})$</span> $+$ <span title = "Total mortality of stock s at age 3 during time step 4">$TotMort_{s,a \! = \! 3,t \! = \! 4})$</span> $\div (1 -$ <span title = "Discrete natural mortality at age 3 during time step 4">$M_{a \! = \! 3,t \! = \! 4})$</span> $+$ <span title = "Total mortality of stock s at age 3 during time step 3">$TotMort_{s, a \! = \! 3,t \! = \! 3})$</span> $\div (1 -$ <span title = "Discrete natural mortality at age 3 during time step 3">$M_{a \! = \! 3,t \! = \! 3})$</span> $+$ <span title = "Total mortality of stock s at age 3 during time step 2">$TotMort_{s,a \! = \! 3,t \! = \! 2})$</span> $\div (1 -$ <span title = "Discrete natural mortality at age 3 during time step 2">$M_{a \! = \! 3,t \! = \! 2})$</span> $+$ <span title = "Total mortality of stock s at age 3 during time step 1">$TotMort_{s,a \! = \! 3,t \! = \! 1})$</span> $\div (1 -$ <span title = "Discrete natural mortality at age 3 during time step 1">$M_{a \! = \! 3,t \! = \! 1}))$</span> $\div$ <span title = "Base period starting cohort abundance of stock s at age 3">$BPCohort_{s,a \! = \! 3}$</span> </div> </p>

where:

- $BkTarget$ is the <span title = "bkFRAM: backwards FRAM">BkFRAM</span> escapement target
- $BPCohort$ is the base period starting cohort abundance
- $StockScaler$ is the stock recruit scaler (abundance)

The program iterates until the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> escapement is within one fish of the target stock escapement and then terminates the iteration process. 

<p>**(17)**<div style = "text-align:center"><span title = "Escapement estimate from a forward FRAM calculation for stock s at age 3">$| \ FRAMescapement_{s,a \! = \! 3}$</span> $-$ <span title = "Backwards FRAM escapement or (extreme) terminal run size target of stock s at age 3">$BkTarget_{s,a \! = \! 3} \ |$</span> $\le 1$ </div> </p>

where:

- <span title = "Escapement estimate from a forward FRAM calculation">$FRAMescapement$</span> is the escapement resulting from a forward <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> run.

# 7. Output Reports

Model results are available in <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> screen reports viewed within the software, <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> reports, <span title = "TAMM: Terminal Area Management Module">TAMM</span> Microsoft Excel files, or can be extracted from the species-specific Microsoft Access database associated with the <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> run.  <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> reports include summaries of projected catch and mortalities by fishery, stock, and age. The <span title = "TAMM: Terminal Area Management Module">TAMM</span> files provide comprehensive summaries of fishery mortalities, exploitation rates, run sizes, and escapements for key stocks in the <span title = "PFMC: Pacific Fishery Management Council">PFMC</span> and North of Falcon (<a href = "https://framverse.github.io/fram_doc/calcs_glossary.html#North_of_Falcon_(NOF)" target = "_blank" title = "NOF: North of Falcon">NOF</a>) annual pre-season planning process, as well as Canadian Coho stocks relevant to the Pacific Salmon Treaty (PST). For a full scope of <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> report generating functions, refer to the online <span title = "FRAM: Fishery Regulation Assessment Model">FRAM</span> User Manual.
